name: "CodeQL config"

# Paths to ignore during the analysis.
paths-ignore:
  - "**/project_backup_*/**"
  - "**/backup/**"
  - "**/node_modules/**"
  - "**/vendor/**"
  - "**/.build/**"
  - "**/build/**"
  - "**/dist/**"

# Configure the build mode for compiled languages
queries:
  - uses: security-extended
  - uses: security-and-quality

# Language-specific configuration
languages:
  # JavaScript/TypeScript configuration
  javascript:
    # No special config needed
  
  # Python configuration  
  python:
    # No special config needed
  
  # C/C++ configuration (for iOS/Objective-C)
  cpp:
    # Specify the build command for iOS
    build-command: |
      cd apps/ios
      # Create placeholder config files for build
      echo "// CI Placeholder" > Supabase.xcconfig
      echo "SUPABASE_URL = https://placeholder.supabase.co" >> Supabase.xcconfig
      echo "SUPABASE_ANON_KEY = placeholder-key" >> Supabase.xcconfig
      echo "// CI Placeholder" > LogYourBody/Config.xcconfig
      echo "CLERK_PUBLISHABLE_KEY = placeholder-clerk-key" >> LogYourBody/Config.xcconfig
      # Build the project
      xcodebuild -project LogYourBody.xcodeproj \
        -scheme LogYourBody \
        -destination 'generic/platform=iOS' \
        -configuration Debug \
        CODE_SIGNING_REQUIRED=NO \
        CODE_SIGNING_ALLOWED=NO \
        ONLY_ACTIVE_ARCH=NO \
        build