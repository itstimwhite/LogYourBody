{"version":3,"file":"plugin.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst SignInWithApple = registerPlugin('SignInWithApple', {\n    web: () => import('./web').then((m) => new m.SignInWithAppleWeb()),\n});\nexport * from './definitions';\nexport { SignInWithApple };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nimport * as $script from 'scriptjs';\nexport class SignInWithAppleWeb extends WebPlugin {\n    constructor() {\n        super(...arguments);\n        this.appleScriptUrl = 'https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js';\n        this.isAppleScriptLoaded = false;\n    }\n    async authorize(options) {\n        return new Promise((resolve, reject) => {\n            if (options) {\n                this.loadSignInWithAppleJS().then((loaded) => {\n                    var _a, _b, _c;\n                    this.isAppleScriptLoaded = loaded;\n                    if (this.isAppleScriptLoaded) {\n                        AppleID.auth.init({\n                            clientId: options.clientId,\n                            redirectURI: options.redirectURI,\n                            scope: (_a = options.scopes) !== null && _a !== void 0 ? _a : undefined,\n                            state: (_b = options.state) !== null && _b !== void 0 ? _b : undefined,\n                            nonce: (_c = options.nonce) !== null && _c !== void 0 ? _c : undefined,\n                            usePopup: true,\n                        });\n                        AppleID.auth\n                            .signIn()\n                            .then((res) => {\n                            var _a, _b, _c, _d, _e;\n                            const response = {\n                                response: {\n                                    user: null,\n                                    email: (_a = res.user) === null || _a === void 0 ? void 0 : _a.email,\n                                    givenName: (_c = (_b = res.user) === null || _b === void 0 ? void 0 : _b.name) === null || _c === void 0 ? void 0 : _c.firstName,\n                                    familyName: (_e = (_d = res.user) === null || _d === void 0 ? void 0 : _d.name) === null || _e === void 0 ? void 0 : _e.lastName,\n                                    identityToken: res.authorization.id_token,\n                                    authorizationCode: res.authorization.code,\n                                },\n                            };\n                            resolve(response);\n                        })\n                            .catch((err) => {\n                            reject(err);\n                        });\n                    }\n                    else {\n                        reject('Unable to load Sign in with Apple JS framework.');\n                    }\n                });\n            }\n            else {\n                reject('No options were provided.');\n            }\n        });\n    }\n    loadSignInWithAppleJS() {\n        return new Promise((resolve) => {\n            if (!this.isAppleScriptLoaded) {\n                if (typeof window !== undefined) {\n                    $script.get(this.appleScriptUrl, () => resolve(true));\n                }\n                else {\n                    resolve(false);\n                }\n            }\n            else {\n                resolve(true);\n            }\n        });\n    }\n}\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin","$script"],"mappings":"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"}