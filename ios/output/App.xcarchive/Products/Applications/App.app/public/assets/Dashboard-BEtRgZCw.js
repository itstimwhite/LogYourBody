const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/WeightStep-NAHvKBP9.js","assets/ui-vendor-B29bBmtv.js","assets/react-vendor-CGPzL8fz.js","assets/index-BXn5fie0.js","assets/data-vendor-CtvEhjhB.js","assets/utils-vendor-eZsCaz-O.js","assets/analytics-vendor-CXgENQ1a.js","assets/index-CjjUa7Uq.css","assets/weight-logging-DDOSsiCQ.js","assets/use-is-mounted-BS5eygNt.js","assets/focus-management-6kc7Qb5h.js","assets/use-supabase-body-metrics-BQdYD7Am.js","assets/input-CNy6IyKs.js","assets/label-Cv8kb5SZ.js","assets/progress-BAm9950D.js","assets/VersionDisplay-hsVI5a3E.js","assets/prefetch-DuFvdqm2.js","assets/use-swipe-navigation-Br04oNeb.js","assets/BodyFatStep-Ba7g0fqf.js","assets/MethodStep-ChE6fS82.js","assets/radio-group-BXTCuRDb.js","assets/bugs-2q_Jw5H1.js","assets/ReviewStep-DqmmdIcB.js","assets/AvatarSilhouette-jdYYgwoS.js"])))=>i.map(i=>d[i]);
import{_ as Q}from"./data-vendor-CtvEhjhB.js";import{j as e}from"./ui-vendor-B29bBmtv.js";import{a as o,R as S,u as at}from"./react-vendor-CGPzL8fz.js";import{m as I,c as j,A as ce,n as Ue,h as le,B as _,g as st,H as me,I as xe,s as pe,u as ye,o as rt,C as nt,b as it,d as lt,e as ot,f as ct}from"./index-BXn5fie0.js";import{f as dt,w as ut,e as ht,S as Re}from"./use-is-mounted-BS5eygNt.js";import{f as He,d as mt,K as ee,y as te,n as oe,a as O,$ as Be,q as xt,_ as We,L as ae,s as ne,O as Ce,u as Z,t as ft,j as $,k as z,l as L,r as ie,b as gt,P as X}from"./focus-management-6kc7Qb5h.js";import{D as we,a as je,b as pt,c as bt,u as vt}from"./use-supabase-body-metrics-BQdYD7Am.js";import{I as be}from"./input-CNy6IyKs.js";import{L as V}from"./label-Cv8kb5SZ.js";import{S as Ke,a as Oe,b as Ve,c as ze,d as K,P as yt}from"./progress-BAm9950D.js";import{L as wt,d as jt,s as Nt,u as St,k as Ge,p as kt,n as Pt,A as Ft,S as Ie,v as Ct,e as It,a as Dt,w as Tt,X as Ye,b as _t,x as Et,H as Mt,P as De,y as Te}from"./utils-vendor-eZsCaz-O.js";import{V as At}from"./VersionDisplay-hsVI5a3E.js";import{p as G}from"./prefetch-DuFvdqm2.js";import{u as $t}from"./use-swipe-navigation-Br04oNeb.js";function Lt({onFocus:a}){let[t,s]=o.useState(!0),r=dt();return t?S.createElement(He,{as:"button",type:"button",features:mt.Focusable,onFocus:l=>{l.preventDefault();let i,n=50;function c(){if(n--<=0){i&&cancelAnimationFrame(i);return}if(a()){if(cancelAnimationFrame(i),!r.current)return;s(!1);return}i=requestAnimationFrame(c)}i=requestAnimationFrame(c)}}):null}const qe=o.createContext(null);function Ut(){return{groups:new Map,get(a,t){var s;let r=this.groups.get(a);r||(r=new Map,this.groups.set(a,r));let l=(s=r.get(t))!=null?s:0;r.set(t,l+1);let i=Array.from(r.keys()).indexOf(t);function n(){let c=r.get(t);c>1?r.set(t,c-1):r.delete(t)}return[i,n]}}}function Rt({children:a}){let t=o.useRef(Ut());return o.createElement(qe.Provider,{value:t},a)}function Je(a){let t=o.useContext(qe);if(!t)throw new Error("You must wrap your component in a <StableCollection>");let s=o.useId(),[r,l]=t.current.get(a,s);return o.useEffect(()=>l,[]),r}var Ht=(a=>(a[a.Forwards=0]="Forwards",a[a.Backwards=1]="Backwards",a))(Ht||{}),Bt=(a=>(a[a.Less=-1]="Less",a[a.Equal=0]="Equal",a[a.Greater=1]="Greater",a))(Bt||{}),Wt=(a=>(a[a.SetSelectedIndex=0]="SetSelectedIndex",a[a.RegisterTab=1]="RegisterTab",a[a.UnregisterTab=2]="UnregisterTab",a[a.RegisterPanel=3]="RegisterPanel",a[a.UnregisterPanel=4]="UnregisterPanel",a))(Wt||{});let Kt={0(a,t){var s;let r=X(a.tabs,x=>x.current),l=X(a.panels,x=>x.current),i=r.filter(x=>{var g;return!((g=x.current)!=null&&g.hasAttribute("disabled"))}),n={...a,tabs:r,panels:l};if(t.index<0||t.index>r.length-1){let x=Z(Math.sign(t.index-a.selectedIndex),{[-1]:()=>1,0:()=>Z(Math.sign(t.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(i.length===0)return n;let g=Z(x,{0:()=>r.indexOf(i[0]),1:()=>r.indexOf(i[i.length-1])});return{...n,selectedIndex:g===-1?a.selectedIndex:g}}let c=r.slice(0,t.index),u=[...r.slice(t.index),...c].find(x=>i.includes(x));if(!u)return n;let m=(s=r.indexOf(u))!=null?s:a.selectedIndex;return m===-1&&(m=a.selectedIndex),{...n,selectedIndex:m}},1(a,t){if(a.tabs.includes(t.tab))return a;let s=a.tabs[a.selectedIndex],r=X([...a.tabs,t.tab],i=>i.current),l=a.selectedIndex;return a.info.current.isControlled||(l=r.indexOf(s),l===-1&&(l=a.selectedIndex)),{...a,tabs:r,selectedIndex:l}},2(a,t){return{...a,tabs:a.tabs.filter(s=>s!==t.tab)}},3(a,t){return a.panels.includes(t.panel)?a:{...a,panels:X([...a.panels,t.panel],s=>s.current)}},4(a,t){return{...a,panels:a.panels.filter(s=>s!==t.panel)}}},Ne=o.createContext(null);Ne.displayName="TabsDataContext";function Y(a){let t=o.useContext(Ne);if(t===null){let s=new Error(`<${a} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Y),s}return t}let Se=o.createContext(null);Se.displayName="TabsActionsContext";function ke(a){let t=o.useContext(Se);if(t===null){let s=new Error(`<${a} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,ke),s}return t}function Ot(a,t){return Z(t.type,Kt,a,t)}let Vt="div";function zt(a,t){let{defaultIndex:s=0,vertical:r=!1,manual:l=!1,onChange:i,selectedIndex:n=null,...c}=a;const u=r?"vertical":"horizontal",m=l?"manual":"auto";let x=n!==null,g=ne({isControlled:x}),b=te(t),[p,v]=o.useReducer(Ot,{info:g,selectedIndex:n??s,tabs:[],panels:[]}),w=o.useMemo(()=>({selectedIndex:p.selectedIndex}),[p.selectedIndex]),f=ne(i||(()=>{})),d=ne(p.tabs),h=o.useMemo(()=>({orientation:u,activation:m,...p}),[u,m,p]),y=O(P=>(v({type:1,tab:P}),()=>v({type:2,tab:P}))),k=O(P=>(v({type:3,panel:P}),()=>v({type:4,panel:P}))),F=O(P=>{D.current!==P&&f.current(P),x||v({type:0,index:P})}),D=ne(x?a.selectedIndex:p.selectedIndex),T=o.useMemo(()=>({registerTab:y,registerPanel:k,change:F}),[]);oe(()=>{v({type:0,index:n??s})},[n]),oe(()=>{if(D.current===void 0||p.tabs.length<=0)return;let P=X(p.tabs,A=>A.current);P.some((A,H)=>p.tabs[H]!==A)&&F(P.indexOf(p.tabs[D.current]))});let R={ref:b},M=ae();return S.createElement(Rt,null,S.createElement(Se.Provider,{value:T},S.createElement(Ne.Provider,{value:h},h.tabs.length<=0&&S.createElement(Lt,{onFocus:()=>{var P,A;for(let H of d.current)if(((P=H.current)==null?void 0:P.tabIndex)===0)return(A=H.current)==null||A.focus(),!0;return!1}}),M({ourProps:R,theirProps:c,slot:w,defaultTag:Vt,name:"Tabs"}))))}let Gt="div";function Yt(a,t){let{orientation:s,selectedIndex:r}=Y("Tab.List"),l=te(t),i=o.useMemo(()=>({selectedIndex:r}),[r]),n=a,c={ref:l,role:"tablist","aria-orientation":s};return ae()({ourProps:c,theirProps:n,slot:i,defaultTag:Gt,name:"Tabs.List"})}let qt="button";function Jt(a,t){var s,r;let l=o.useId(),{id:i=`headlessui-tabs-tab-${l}`,disabled:n=!1,autoFocus:c=!1,...u}=a,{orientation:m,activation:x,selectedIndex:g,tabs:b,panels:p}=Y("Tab"),v=ke("Tab"),w=Y("Tab"),[f,d]=o.useState(null),h=o.useRef(null),y=te(h,t,d);oe(()=>v.registerTab(h),[v,h]);let k=Je("tabs"),F=b.indexOf(h);F===-1&&(F=k);let D=F===g,T=O(N=>{var C;let U=N();if(U===ie.Success&&x==="auto"){let B=(C=gt(h))==null?void 0:C.activeElement,Fe=w.tabs.findIndex(tt=>tt.current===B);Fe!==-1&&v.change(Fe)}return U}),R=O(N=>{let C=b.map(U=>U.current).filter(Boolean);if(N.key===$.Space||N.key===$.Enter){N.preventDefault(),N.stopPropagation(),v.change(F);return}switch(N.key){case $.Home:case $.PageUp:return N.preventDefault(),N.stopPropagation(),T(()=>z(C,L.First));case $.End:case $.PageDown:return N.preventDefault(),N.stopPropagation(),T(()=>z(C,L.Last))}if(T(()=>Z(m,{vertical(){return N.key===$.ArrowUp?z(C,L.Previous|L.WrapAround):N.key===$.ArrowDown?z(C,L.Next|L.WrapAround):ie.Error},horizontal(){return N.key===$.ArrowLeft?z(C,L.Previous|L.WrapAround):N.key===$.ArrowRight?z(C,L.Next|L.WrapAround):ie.Error}}))===ie.Success)return N.preventDefault()}),M=o.useRef(!1),P=O(()=>{var N;M.current||(M.current=!0,(N=h.current)==null||N.focus({preventScroll:!0}),v.change(F),ft(()=>{M.current=!1}))}),A=O(N=>{N.preventDefault()}),{isFocusVisible:H,focusProps:Pe}=Be({autoFocus:c}),{isHovered:se,hoverProps:de}=xt({isDisabled:n}),{pressed:re,pressProps:q}=ut({disabled:n}),ue=o.useMemo(()=>({selected:D,hover:se,active:re,focus:H,autofocus:c,disabled:n}),[D,se,H,re,c,n]),he=We({ref:y,onKeyDown:R,onMouseDown:A,onClick:P,id:i,role:"tab",type:ht(a,f),"aria-controls":(r=(s=p[F])==null?void 0:s.current)==null?void 0:r.id,"aria-selected":D,tabIndex:D?0:-1,disabled:n||void 0,autoFocus:c},Pe,de,q);return ae()({ourProps:he,theirProps:u,slot:ue,defaultTag:qt,name:"Tabs.Tab"})}let Xt="div";function Zt(a,t){let{selectedIndex:s}=Y("Tab.Panels"),r=te(t),l=o.useMemo(()=>({selectedIndex:s}),[s]),i=a,n={ref:r};return ae()({ourProps:n,theirProps:i,slot:l,defaultTag:Xt,name:"Tabs.Panels"})}let Qt="div",ea=Ce.RenderStrategy|Ce.Static;function ta(a,t){var s,r,l,i;let n=o.useId(),{id:c=`headlessui-tabs-panel-${n}`,tabIndex:u=0,...m}=a,{selectedIndex:x,tabs:g,panels:b}=Y("Tab.Panel"),p=ke("Tab.Panel"),v=o.useRef(null),w=te(v,t);oe(()=>p.registerPanel(v),[p,v]);let f=Je("panels"),d=b.indexOf(v);d===-1&&(d=f);let h=d===x,{isFocusVisible:y,focusProps:k}=Be(),F=o.useMemo(()=>({selected:h,focus:y}),[h,y]),D=We({ref:w,id:c,role:"tabpanel","aria-labelledby":(r=(s=g[d])==null?void 0:s.current)==null?void 0:r.id,tabIndex:h?u:-1},k),T=ae();return!h&&((l=m.unmount)==null||l)&&!((i=m.static)!=null&&i)?S.createElement(He,{"aria-hidden":"true",...D}):T({ourProps:D,theirProps:m,slot:F,defaultTag:Qt,features:ea,visible:h,name:"Tabs.Panel"})}let aa=ee(Jt),sa=ee(zt),ra=ee(Yt),na=ee(Zt),ia=ee(ta),J=Object.assign(aa,{Group:sa,List:ra,Panels:na,Panel:ia});const la={animation:{spring:{type:"spring",damping:20,stiffness:300},fadeIn:{duration:.25,ease:"easeOut"},slideIn:{duration:.3,ease:"easeInOut"}}},W=a=>la.animation[a],E={profileValue:"text-xl md:text-3xl lg:text-4xl font-semibold leading-none text-linear-text",profileLabel:"text-[10px] md:text-sm font-medium uppercase opacity-70 tracking-wider text-linear-text-secondary",profileUnit:"text-lg md:text-2xl font-medium opacity-80 text-linear-text-secondary",attributeLabel:"text-[9px] md:text-xs font-medium uppercase opacity-70 tracking-wider text-linear-text-tertiary",attributeValue:"text-[11px] md:text-sm font-semibold text-linear-text",timelineLabel:"text-[9px] md:text-xs font-medium opacity-70 text-linear-text-tertiary",timelineValue:"text-xs md:text-base font-semibold text-linear-text",statsGrid:"grid grid-cols-2 gap-2 md:flex md:flex-col md:gap-4",attributeRow:"grid grid-cols-3 gap-2 min-h-[32px] md:min-h-[48px]",avatarContainer:"relative h-[35vh] max-h-[280px] md:h-full w-full",safeArea:"pb-[env(safe-area-inset-bottom)]"},oa=S.memo(function({metrics:t,formattedWeight:s,formattedLeanBodyMass:r,className:l}){const i=W("fadeIn"),n=[{value:t.bodyFatPercentage>0?t.bodyFatPercentage.toFixed(1):"--",unit:t.bodyFatPercentage>0?"%":void 0,label:"Body Fat",accessibilityLabel:`Body fat percentage: ${t.bodyFatPercentage>0?t.bodyFatPercentage.toFixed(1)+" percent":"not available"}`},{value:s,label:"Weight",accessibilityLabel:`Weight: ${s}`},{value:isNaN(t.ffmi)||!isFinite(t.ffmi)?"--":t.ffmi.toFixed(1),label:"FFMI",accessibilityLabel:`Fat Free Mass Index: ${isNaN(t.ffmi)||!isFinite(t.ffmi)?"not available":t.ffmi.toFixed(1)}`},{value:r,label:"Lean Body Mass",accessibilityLabel:`Lean body mass: ${r}`},{value:t.stepCount?t.stepCount.toString():"0",label:"Steps",accessibilityLabel:`Step count: ${t.stepCount??0}`}];return e.jsx(I.div,{className:j(E.statsGrid,"mb-3 md:mb-8",l),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:i,children:n.map((c,u)=>e.jsxs(I.div,{className:"min-w-0 flex-shrink-0 text-center md:text-left",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{...i,delay:u*.05},children:[e.jsxs("div",{className:"flex items-baseline justify-center gap-1 md:justify-start","aria-label":c.accessibilityLabel,children:[e.jsx("span",{className:j(E.profileValue,"font-inter tracking-tight"),children:c.value}),c.unit&&e.jsx("span",{className:E.profileUnit,children:c.unit})]}),e.jsx("div",{className:j(E.profileLabel,"mt-0.5"),children:c.label})]},c.label))})}),ca=(a,t)=>{S.useEffect(()=>{const s=`Stats updated: Body fat ${a.bodyFatPercentage>0?a.bodyFatPercentage.toFixed(1)+" percent":"not available"}, Weight ${t}, FFMI ${a.ffmi}, Steps ${a.stepCount??0}`,r=document.createElement("div");r.setAttribute("aria-live","polite"),r.setAttribute("aria-atomic","true"),r.style.position="absolute",r.style.left="-10000px",r.style.width="1px",r.style.height="1px",r.style.overflow="hidden",document.body.appendChild(r),setTimeout(()=>{r.textContent=s,setTimeout(()=>{document.body.removeChild(r)},1e3)},100)},[a.bodyFatPercentage,t,a.ffmi])},da=a=>{if(!a)return 0;try{const t=typeof a=="string"?new Date(a):a;if(!t||isNaN(t.getTime()))return console.warn("Invalid birth date provided:",a),0;const l=(new Date().getTime()-t.getTime())/(1e3*60*60*24);return Math.floor(l/365.25)}catch(t){return console.error("Error calculating age:",t,"birthDate:",a),0}},ua=S.memo(function({user:t,userAge:s,formattedHeight:r,className:l}){const i=W("fadeIn"),n=t.birthDate?da(t.birthDate):0,c=n>0?n:s,u=c>0,m=[{label:"Age",value:u?c.toString():"",accessibilityLabel:u?`Age: ${c} years old`:"Age not available",hidden:!u},{label:"Height",value:r,accessibilityLabel:`Height: ${r}`},{label:"Sex",value:t.gender?t.gender.charAt(0).toUpperCase()+t.gender.slice(1):"Not specified",accessibilityLabel:`Sex: ${t.gender||"Not specified"}`}];return e.jsx(I.div,{className:j(E.attributeRow,"pt-3 md:pt-6",l),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{...i,delay:.3},children:m.map((x,g)=>e.jsxs(I.div,{className:j("flex flex-col justify-center text-center md:text-left",x.hidden&&"pointer-events-none opacity-0"),initial:{opacity:0,scale:.95},animate:{opacity:x.hidden?0:1,scale:1},transition:{...i,delay:.4+g*.05},"aria-hidden":x.hidden,children:[e.jsx("div",{className:j(E.attributeLabel,"mb-1"),children:x.label}),e.jsx("div",{className:E.attributeValue,"aria-label":x.accessibilityLabel,children:x.value||"-"})]},x.label))})}),ha=(a,t,s)=>{S.useEffect(()=>{const r=[];if(t>0&&r.push(`${t} years old`),s&&r.push(`Height ${s}`),a.gender&&r.push(`${a.gender}`),r.length>0){const l=`User profile: ${r.join(", ")}`,i=document.createElement("div");i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),i.style.position="absolute",i.style.left="-10000px",i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",document.body.appendChild(i),setTimeout(()=>{i.textContent=l,setTimeout(()=>{document.body.removeChild(i)},1e3)},100)}},[a.gender,t,s])},ma=S.memo(function({metrics:t,user:s,userAge:r,formattedWeight:l,formattedHeight:i,formattedLeanBodyMass:n,className:c}){const u=W("fadeIn");return ca(t,l),ha(s,r,i),S.useEffect(()=>{typeof window<"u"&&window.gtag&&window.gtag("event","profile_viewed",{event_category:"Profile",event_label:"Profile Panel",custom_parameters:{user_has_name:!!s.name,user_has_height:!!i,user_has_age:r>0,body_fat_percentage:t.bodyFatPercentage,ffmi:t.ffmi}})},[t,s,r,i]),e.jsxs(I.div,{className:j("flex h-full w-full flex-col justify-center p-3 md:p-6","bg-linear-bg/95 backdrop-blur-sm",c),initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:u,role:"region","aria-label":"User profile and body metrics",children:[e.jsx(I.div,{className:"mb-3 md:mb-8",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{...u,delay:.1},children:e.jsx("h1",{className:"text-sm font-semibold tracking-tight text-linear-text md:text-lg",children:s.name||"Anonymous User"})}),e.jsx(oa,{metrics:t,formattedWeight:l,formattedLeanBodyMass:n}),e.jsx("div",{className:"mt-auto border-t border-linear-border/30",children:e.jsx(ua,{user:s,userAge:r,formattedHeight:i})})]})}),xa=S.memo(function({metrics:t,selectedIndex:s,onIndexChange:r,className:l}){const i=W("fadeIn"),[n,c]=o.useState({selectedIndex:s,isDragging:!1,announcement:""});o.useEffect(()=>{c(h=>({...h,selectedIndex:s}))},[s]);const u=o.useCallback(h=>h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),[]),m=o.useCallback(h=>h.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),[]),x=o.useCallback(h=>{const y=h[0];c(F=>({...F,selectedIndex:y})),r(y);const k=t[y];if(k){const F=`Entry ${y+1} of ${t.length}, ${m(k.date)}`;c(D=>({...D,announcement:F}))}typeof window<"u"&&window.gtag&&window.gtag("event","timeline_changed",{event_category:"Profile",event_label:"Timeline Navigation",value:y,custom_parameters:{total_entries:t.length,entry_date:k?u(k.date):null}})},[t,r,u,m]),g=o.useCallback(()=>{c(h=>({...h,isDragging:!0}))},[]),b=o.useCallback(()=>{c(h=>({...h,isDragging:!1}))},[]),p=o.useMemo(()=>t[n.selectedIndex],[t,n.selectedIndex]);if(t.length===0)return null;const v=p?.date,w=t[0]?.date,f=t[t.length-1]?.date,d={value:[n.selectedIndex],onValueChange:x,onPointerDown:g,onPointerUp:b,max:t.length-1,min:0,step:1,"aria-label":`Timeline slider. Entry ${n.selectedIndex+1} of ${t.length}`,"aria-valuetext":v?`${m(v)}, entry ${n.selectedIndex+1} of ${t.length}`:void 0,"aria-describedby":"timeline-description"};return e.jsxs(I.div,{className:j("w-full border-t border-linear-border/50 bg-linear-bg shadow-sm",E.safeArea,l),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:i,children:[e.jsx("div",{className:"px-4 py-3 md:px-6 md:py-6",children:e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs(I.div,{className:"text-center",layout:!0,children:[e.jsx("div",{className:j(E.timelineValue,"tracking-tight"),"aria-live":"polite","aria-atomic":"true",children:v?u(v):"No date"}),e.jsxs("div",{className:j(E.timelineLabel,"mt-1"),id:"timeline-description",children:["Entry ",n.selectedIndex+1," of ",t.length]})]}),e.jsx("div",{className:"px-2 md:px-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Re,{...d,className:j("timeline-slider w-full","[&_[role=slider]]:h-6 [&_[role=slider]]:w-6","[&_[role=slider]]:border-2 [&_[role=slider]]:border-background","[&_[role=slider]]:shadow-lg [&_[role=slider]]:focus:shadow-xl","[&_.relative]:h-2")}),t.length>1&&e.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-1/2 flex -translate-y-1/2 transform justify-between",children:[e.jsx("div",{className:"h-1 w-1 rounded-full bg-muted-foreground/50"}),e.jsx("div",{className:"h-1 w-1 rounded-full bg-muted-foreground/50"})]})]})}),t.length>1&&w&&f&&e.jsxs(I.div,{className:"flex justify-between px-2 md:px-4",initial:{opacity:0},animate:{opacity:1},transition:{...i,delay:.2},children:[e.jsx("span",{className:j(E.timelineLabel,"text-left"),"aria-label":`Earliest entry: ${m(w)}`,children:u(w)}),e.jsx("span",{className:j(E.timelineLabel,"text-right"),"aria-label":`Latest entry: ${m(f)}`,children:u(f)})]})]})}),e.jsx("div",{className:"sr-only","aria-live":"polite","aria-atomic":"true",children:n.announcement})]})}),_e=S.memo(function({src:t,alt:s,srcSet:r,sizes:l,placeholder:i="/placeholder.svg",className:n,fallback:c,...u}){const[m,x]=o.useState(!1),[g,b]=o.useState(!1),[p,v]=o.useState(!1),w=o.useRef(null);o.useEffect(()=>{const h=new IntersectionObserver(([y])=>{y.isIntersecting&&(b(!0),h.disconnect())},{threshold:.1});return w.current&&h.observe(w.current),()=>h.disconnect()},[]);const f=()=>{x(!0),v(!1)},d=()=>{v(!0),x(!1)};return p&&c?e.jsx(e.Fragment,{children:c}):e.jsxs("div",{ref:w,className:j("relative overflow-hidden",n),children:[!m&&i&&e.jsx("img",{src:i,alt:"",className:j("absolute inset-0 h-full w-full object-cover transition-opacity duration-300",m?"opacity-0":"opacity-100"),"aria-hidden":"true"}),!m&&g&&e.jsx("div",{className:"absolute inset-0 animate-pulse bg-gradient-to-r from-transparent via-white/20 to-transparent"}),g&&e.jsx("img",{src:t,srcSet:r,sizes:l,alt:s,onLoad:f,onError:d,className:j("h-full w-full object-cover transition-opacity duration-300",m?"opacity-100":"opacity-0"),loading:"lazy",...u})]})});function Ee(a,t){const s=a.includes("?")?"&":"?";return`${a}${s}width=${t} 1x, ${a}${s}width=${t*2} 2x`}function fa(a){return Math.max(5,Math.min(50,Math.round(a/5)*5))}function ga(a){const{bodyFat:t=20,gender:s="male"}=a;return{bodyFat:fa(t),sex:s==="female"?"f":"m"}}function pa(a){return`${a.sex}_bf${a.bodyFat}.svg`}function Xe(a){return`/avatars/${pa(a)}`}function ba(a){const t=ga(a);return Xe(t)}function va(a){const t={bodyFat:20,sex:a.sex};return Xe(t)}const Me=S.memo(function({gender:t,bodyFatPercentage:s,showPhoto:r,profileImage:l,className:i,weight:n=70,height:c=170,age:u=30}){W("fadeIn");const m=W("spring"),[x,g]=o.useState(!1),b=o.useMemo(()=>ba({bodyFat:s,gender:t}),[n,c,s,u,t]),p=o.useMemo(()=>va({sex:t==="female"?"f":"m"}),[s,t]),v=()=>{g(!0)},w=()=>{g(!1)};return e.jsx("div",{className:j(E.avatarContainer,"overflow-hidden",i),children:e.jsx("div",{className:"flex h-full items-center justify-center p-4",children:e.jsx(ce,{mode:"wait",children:r&&l?e.jsx(I.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:m,className:"max-h-full max-w-full",children:e.jsx(_e,{src:l,srcSet:Ee(l,400),sizes:"(min-width: 768px) 400px, 100vw",alt:"Profile photo showing current body composition",className:"max-h-full max-w-full rounded-lg object-contain shadow-lg"})},"photo"):e.jsx(I.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:m,className:"flex h-64 w-40 items-center justify-center md:h-80 md:w-48",children:e.jsx(_e,{src:x?p:b,srcSet:Ee(x?p:b,256),sizes:"(min-width: 768px) 256px, 40vw",alt:`${t} body composition wireframe showing ${(s||0).toFixed(1)}% body fat`,className:"h-full w-full object-contain",onError:v,onLoad:w,style:{filter:"drop-shadow(0 0 8px rgba(255, 255, 255, 0.1))"}})},"avatar")})})})}),ya=S.memo(function({tabs:t,defaultIndex:s=0,onTabChange:r,className:l,swipeEnabled:i=!0}){const[n,c]=o.useState(s),[u,m]=o.useState(null),x=W("spring"),g=W("fadeIn"),b=o.useRef(null),p=f=>{c(f),r?.(f),typeof window<"u"&&window.gtag&&window.gtag("event","tab_changed",{event_category:"Profile",event_label:"Tab Navigation",value:f,custom_parameters:{tab_name:t[f]?.label,total_tabs:t.length}})},v=(f,d)=>{if(!i)return;(Math.abs(d.offset.x)>50||Math.abs(d.velocity.x)>500)&&(d.offset.x>0&&n>0?p(n-1):d.offset.x<0&&n<t.length-1&&p(n+1)),m(null)},w=(f,d)=>{i&&(d.velocity.x>0?m("right"):d.velocity.x<0&&m("left"))};return t.length===0?null:e.jsxs("div",{className:j("flex h-full flex-col",l),children:[e.jsxs(J.Group,{selectedIndex:n,onChange:p,children:[e.jsx("div",{className:"pt-safe-top flex-shrink-0",children:e.jsx(J.List,{className:"m-4 flex justify-center rounded-xl bg-secondary/20 p-1",children:t.map((f,d)=>e.jsx(J,{className:({selected:h})=>j("relative flex-1 rounded-lg px-6 py-3 text-sm font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2","min-h-[48pt]",h?"bg-primary text-white shadow-sm":"text-muted-foreground hover:bg-secondary/30 hover:text-foreground"),"aria-label":`Switch to ${f.label} view`,children:({selected:h})=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"relative z-10",children:f.label}),h&&e.jsx(I.div,{className:"absolute inset-0 rounded-lg bg-primary",layoutId:"activeTab",transition:x})]})},f.id))})}),e.jsx("div",{ref:b,className:"relative flex-1 overflow-hidden",children:e.jsx(J.Panels,{className:"h-full",children:e.jsx(ce,{mode:"wait",initial:!1,children:t.map((f,d)=>e.jsx(J.Panel,{className:j("h-full w-full focus:outline-none",d===n?"block":"hidden"),tabIndex:-1,children:e.jsx(I.div,{className:"h-full w-full",drag:i?"x":!1,dragConstraints:{left:0,right:0},dragElastic:.1,onDragStart:w,onDragEnd:v,initial:{opacity:0,x:d>n?20:d<n?-20:0},animate:{opacity:1,x:0,scale:u?.98:1},exit:{opacity:0,x:d>n?20:-20},transition:x,whileDrag:{scale:.98,rotateY:u==="left"?-2:u==="right"?2:0},children:f.content})},`${f.id}-${n}`))})})})]}),i&&u&&e.jsx(I.div,{className:"pointer-events-none absolute bottom-4 left-1/2 z-50 -translate-x-1/2 transform",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:g,children:e.jsxs("div",{className:"rounded-full bg-black/60 px-3 py-1 text-xs font-medium text-white backdrop-blur-sm",children:[u==="left"&&n<t.length-1&&"Swipe to next →",u==="right"&&n>0&&"← Swipe to previous"]})})]})}),wa=(a,t,s)=>{const r=[{id:"avatar",label:"Avatar",content:a},{id:"photo",label:"Photo",content:t}];return s&&r.push({id:"progress",label:"Progress",content:s}),r},ja={dexa:"DEXA Scan",scale:"Smart Scale",calipers:"Calipers",visual:"Visual Estimate",healthkit:"HealthKit"};function Na({open:a,onOpenChange:t,onSave:s,units:r}){const[l,i]=o.useState(""),[n,c]=o.useState([15]),[u,m]=o.useState("scale"),[x,g]=o.useState(!1),b=Ue(),p=()=>{const f=parseFloat(l);isNaN(f)||f<=0||(s({weight:f,bodyFatPercentage:n[0],method:u,date:new Date}),i(""),c([15]),m("scale"),t(!1))},v=()=>{i(""),c([15]),m("scale"),t(!1)},w=async()=>{if(!(!le()||!b.isAvailable)){g(!0);try{if(!b.isAuthorized&&!await b.requestPermissions()){console.warn("HealthKit permissions not granted");return}const f=await b.getHealthData();if(f&&f.weight){let d=f.weight;r==="imperial"&&(d=Math.round(f.weight*2.20462*10)/10),s({weight:f.weight,bodyFatPercentage:n[0],method:"healthkit",date:new Date}),i(""),c([15]),m("scale"),t(!1),console.log("HealthKit data imported:",d,r==="imperial"?"lbs":"kg")}else console.warn("No weight data found in HealthKit")}catch(f){console.error("Error importing HealthKit data:",f)}finally{g(!1)}}};return e.jsx(we,{open:a,onOpenChange:v,children:e.jsxs(je,{className:"max-w-md border-border bg-background text-foreground",children:[e.jsx(pt,{children:e.jsx(bt,{className:"text-xl font-semibold tracking-tight text-foreground",children:"Log New Measurement"})}),e.jsxs("div",{className:"space-y-6 py-4",children:[le()&&b.isAvailable&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(V,{className:"text-sm font-medium uppercase tracking-wide text-muted-foreground",children:"Import from HealthKit"}),e.jsx(_,{type:"button",variant:"outline",onClick:w,disabled:x,className:"h-12 w-full border-border bg-secondary text-foreground hover:bg-muted",children:x?e.jsxs(e.Fragment,{children:[e.jsx(wt,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing from HealthKit..."]}):e.jsxs(e.Fragment,{children:[e.jsx(jt,{className:"mr-2 h-4 w-4"}),"Import from HealthKit"]})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-border"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or enter manually"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(V,{htmlFor:"weight",className:"text-sm font-medium uppercase tracking-wide text-muted-foreground",children:["Weight (",r==="metric"?"kg":"lbs",")"]}),e.jsx(be,{id:"weight",type:"number",placeholder:"Enter weight",value:l,onChange:f=>i(f.target.value),className:"h-12 border-border bg-secondary text-base text-foreground placeholder:text-muted-foreground"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(V,{className:"text-sm font-medium uppercase tracking-wide text-muted-foreground",children:["Body Fat: ",n[0].toFixed(1),"%"]}),e.jsx(Re,{value:n,onValueChange:c,max:50,min:3,step:.1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs font-medium text-muted-foreground",children:[e.jsx("span",{children:"3%"}),e.jsx("span",{children:"50%"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(V,{className:"text-sm font-medium uppercase tracking-wide text-muted-foreground",children:"Method"}),e.jsxs(Ke,{value:u,onValueChange:f=>m(f),children:[e.jsx(Oe,{className:"h-12 border-border bg-secondary text-foreground",children:e.jsx(Ve,{})}),e.jsx(ze,{className:"border-border bg-background",children:Object.entries(ja).filter(([f])=>f!=="healthkit").map(([f,d])=>e.jsx(K,{value:f,className:"text-foreground hover:bg-muted",children:d},f))})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(_,{onClick:p,className:"h-12 w-full bg-primary text-base font-semibold text-primary-foreground hover:bg-primary/90",disabled:!l||parseFloat(l)<=0,children:"Save Measurement"})})]})})}const Ze=o.createContext(null);function Sa({children:a,totalSteps:t,initialStep:s=0,onStepChange:r,onComplete:l}){const[i,n]=o.useState(s),[c,u]=o.useState(!1),m=st.isNativePlatform(),x=i===0,g=i===t-1,b=(i+1)/t*100,p=o.useCallback(async()=>{if(c)if(m&&await me.impact({style:xe.Light}),g)l?.();else{const d=i+1;n(d),u(!1),r?.(d)}},[i,g,c,l,r,m]),v=o.useCallback(async()=>{if(x)return;m&&await me.impact({style:xe.Light});const d=i-1;n(d),u(!0),r?.(d)},[i,x,r,m]),w=o.useCallback(async d=>{d<0||d>=t||d===i||(m&&await me.impact({style:xe.Light}),n(d),u(!0),r?.(d))},[i,t,r,m]),f={currentStep:i,totalSteps:t,isFirstStep:x,isLastStep:g,progress:b,goNext:p,goBack:v,goToStep:w,canGoNext:c,setCanGoNext:u};return e.jsx(Ze.Provider,{value:f,children:a})}function ka(){const a=o.useContext(Ze);if(!a)throw new Error("useStepper must be used within a StepperProvider");return a}class Pa{startTime=null;stepStartTimes={};backNavigationCount=0;usedHealthKit=!1;usedPresets=!1;startFlow(t){this.startTime=Date.now(),this.stepStartTimes={},this.backNavigationCount=0,this.usedHealthKit=!1,this.usedPresets=!1,this.track("log_weight_started",t)}completeStep(t){const s=this.stepStartTimes[t.step_number],r=s?(Date.now()-s)/1e3:0;this.track("step_completed",{...t,time_spent_seconds:Math.round(r*10)/10}),t.interaction_type==="preset"&&(this.usedPresets=!0),t.interaction_type==="healthkit"&&(this.usedHealthKit=!0)}startStep(t){this.stepStartTimes[t]=Date.now()}navigateBack(){this.backNavigationCount++}trackWeightInput(t){this.track("weight_input_method",t)}trackBodyFatInput(t){this.track("body_fat_input_method",t)}trackSave(t){const s=this.startTime?(Date.now()-this.startTime)/1e3:0;this.track("measurement_saved",{...t,total_flow_time_seconds:Math.round(s*10)/10,steps_back_navigated:this.backNavigationCount,used_healthkit:this.usedHealthKit,used_presets:this.usedPresets})}completeFlow(t){console.log("[Analytics] Flow completed:",t)}trackValidationError(t){this.track("validation_error",t)}trackAccessibility(t){this.track("accessibility_interaction",t)}track(t,s){console.log(`[Analytics] ${t}:`,s)}}const ve=new Pa,ms={getInteractionType:a=>a.type==="keydown"||a.type==="keyup"?"keyboard":"tap",getPrecision:a=>{const t=a.toString(),s=t.indexOf(".");return s===-1?0:t.length-s-1},wasSnappedToIncrement:(a,t,s)=>{const r=Math.round(a/s)*s;return Math.abs(t-r)<.001}};async function Fa({file:a,userId:t,bodyMetricsId:s}){try{if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(a.type))throw new Error("Invalid file type. Please upload a JPG, PNG, or WebP image.");const l=10*1024*1024;if(a.size>l)throw new Error("File size too large. Maximum size is 10MB.");const i=new Date().getTime(),n=a.name.split(".").pop(),c=s?`${s}_${i}.${n}`:`progress_${i}.${n}`,u=`${t}/${c}`,{data:m,error:x}=await pe.storage.from("progress-photos").upload(u,a,{cacheControl:"3600",upsert:!1});if(x)throw console.error("Upload error:",x),new Error(x.message);const{data:{publicUrl:g}}=pe.storage.from("progress-photos").getPublicUrl(u);return{url:g,path:u}}catch(r){return console.error("Photo upload error:",r),{url:"",path:"",error:r instanceof Error?r.message:"Failed to upload photo"}}}async function Ca(a){try{const{error:t}=await pe.storage.from("progress-photos").remove([a]);return t?(console.error("Delete error:",t),!1):!0}catch(t){return console.error("Photo delete error:",t),!1}}async function Ia(a,t=1920){return new Promise((s,r)=>{const l=new FileReader;l.readAsDataURL(a),l.onload=i=>{const n=new Image;n.src=i.target?.result,n.onload=()=>{const c=document.createElement("canvas"),u=c.getContext("2d");if(!u){r(new Error("Could not get canvas context"));return}let m=n.width,x=n.height;m>t&&(x=t/m*x,m=t),c.width=m,c.height=x,u.drawImage(n,0,0,m,x),c.toBlob(g=>{if(!g){r(new Error("Compression failed"));return}const b=new File([g],a.name,{type:"image/jpeg",lastModified:Date.now()});s(b)},"image/jpeg",.85)},n.onerror=()=>r(new Error("Image load failed"))},l.onerror=()=>r(new Error("File read failed"))})}function Da(a={}){const{user:t}=ye(),{toast:s}=rt(),[r,l]=o.useState(!1),[i,n]=o.useState(0),c=o.useCallback(async(m,x)=>{if(!t?.id){const g="User not authenticated";return s({title:"Error",description:g,variant:"destructive"}),a.onError?.(g),null}l(!0),n(0);try{let g=m;a.autoCompress!==!1&&(n(10),s({title:"Processing",description:"Compressing image..."}),g=await Ia(m,a.maxWidth||1920),n(30)),s({title:"Uploading",description:"Uploading your photo..."});const b=await Fa({file:g,userId:t.id,bodyMetricsId:x});if(n(100),b.error)throw new Error(b.error);return s({title:"Success",description:"Photo uploaded successfully"}),a.onSuccess?.(b),b}catch(g){const b=g instanceof Error?g.message:"Upload failed";return s({title:"Upload Failed",description:b,variant:"destructive"}),a.onError?.(b),null}finally{l(!1),n(0)}},[t?.id,s,a]),u=o.useCallback(async m=>{try{const x=await Ca(m);if(x)s({title:"Success",description:"Photo deleted successfully"});else throw new Error("Failed to delete photo");return x}catch{return s({title:"Delete Failed",description:"Failed to delete photo",variant:"destructive"}),!1}},[s]);return{uploadPhoto:c,deletePhoto:u,isUploading:r,uploadProgress:i}}function Ta({isOpen:a,onClose:t,onPhotoUploaded:s,bodyMetricsId:r}){const l=o.useRef(null),[i,n]=o.useState(null),[c,u]=o.useState(null),{uploadPhoto:m,isUploading:x,uploadProgress:g}=Da({onSuccess:f=>{s?.(f.url),v()}}),b=o.useCallback(f=>{const d=f.target.files?.[0];if(!d)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(d.type)){alert("Please select a valid image file (JPG, PNG, or WebP)");return}n(d);const y=new FileReader;y.onload=k=>{u(k.target?.result)},y.readAsDataURL(d)},[]),p=async()=>{i&&await m(i,r)},v=()=>{n(null),u(null),l.current&&(l.current.value=""),t()},w=()=>{n(null),u(null),l.current?.click()};return e.jsx(we,{open:a,onOpenChange:v,children:e.jsx(je,{className:"max-w-md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Add Progress Photo"}),e.jsx("p",{className:"text-muted-foreground",children:"Capture your progress with a photo"})]}),e.jsx("input",{ref:l,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:b,className:"hidden",capture:"environment"}),c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative aspect-[3/4] w-full overflow-hidden rounded-lg bg-secondary",children:[e.jsx("img",{src:c,alt:"Progress photo preview",className:"h-full w-full object-cover"}),x&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80",children:e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx(yt,{value:g,className:"w-32"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Uploading... ",g,"%"]})]})})]}),!x&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{variant:"outline",onClick:w,className:"flex-1",children:[e.jsx(Nt,{className:"mr-2 h-4 w-4"}),"Retake"]}),e.jsxs(_,{onClick:p,className:"flex-1",disabled:!i,children:[e.jsx(St,{className:"mr-2 h-4 w-4"}),"Upload"]})]})]}):e.jsxs("div",{onClick:()=>l.current?.click(),className:j("flex aspect-[3/4] w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-border bg-secondary/20 transition-colors hover:border-primary/50 hover:bg-secondary/30"),children:[e.jsx(Ge,{className:"mb-4 h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-lg font-medium text-foreground",children:"Take or select a photo"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"JPG, PNG or WebP • Max 10MB"})]}),!x&&e.jsx(_,{variant:"ghost",onClick:v,className:"w-full",children:"Cancel"}),e.jsxs("div",{className:"rounded-lg bg-secondary/20 p-4 text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium mb-2",children:"Tips for best results:"}),e.jsxs("ul",{className:"space-y-1 ml-4 list-disc",children:[e.jsx("li",{children:"Use consistent lighting and angle"}),e.jsx("li",{children:"Take photos at the same time of day"}),e.jsx("li",{children:"Wear similar clothing each time"}),e.jsx("li",{children:"Use a mirror or timer for consistency"})]})]})]})})})}const _a=S.lazy(()=>Q(()=>import("./WeightStep-NAHvKBP9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])).then(a=>({default:a.WeightStep}))),Ea=S.lazy(()=>Q(()=>import("./BodyFatStep-Ba7g0fqf.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])).then(a=>({default:a.BodyFatStep}))),Ma=S.lazy(()=>Q(()=>import("./MethodStep-ChE6fS82.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,20,10,21,9,11,12,13,14,15,16,17])).then(a=>({default:a.MethodStep}))),Aa=S.lazy(()=>Q(()=>import("./ReviewStep-DqmmdIcB.js"),__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])).then(a=>({default:a.ReviewStep})));function $a({onComplete:a,onCancel:t,initialData:s,weightData:r,setWeightData:l,bodyFatData:i,setBodyFatData:n,methodData:c,setMethodData:u,photoUrl:m,setPhotoUrl:x,showPhotoCapture:g,setShowPhotoCapture:b}){const{currentStep:p,canGoNext:v,goNext:w,goBack:f,goToStep:d,progress:h}=ka(),y=4,k=["Weight","Body Fat","Method","Review"],F=M=>{d(M)},D=()=>{b(!0)},T=M=>{x(M),ve.trackPhotoAdded({photo_url:M})},R=()=>{switch(p){case 0:return e.jsx(_a,{value:r,onChange:l});case 1:return e.jsx(Ea,{value:i,onChange:n});case 2:return e.jsx(Ma,{value:c,onChange:u});case 3:return e.jsx(Aa,{weight:r,bodyFat:i,method:c,onEditStep:F,onAddPhoto:D});default:return null}};return e.jsxs("div",{className:"flex h-full flex-col bg-linear-bg font-inter",children:[e.jsx(Ta,{isOpen:g,onClose:()=>b(!1),onPhotoUploaded:T}),e.jsxs("div",{className:"flex-shrink-0 px-6 pt-safe-top",children:[e.jsxs("div",{className:"flex h-14 items-center justify-between",children:[e.jsx("button",{onClick:p===0?t:f,className:"flex h-10 w-10 items-center justify-center rounded-full bg-linear-border/30 text-linear-text-secondary transition-colors hover:bg-linear-border/50 hover:text-linear-text","aria-label":p===0?"Cancel":"Go back",children:e.jsx(kt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm font-medium text-linear-text-secondary",children:["Step ",p+1," of ",y]}),e.jsx("div",{className:"text-lg font-semibold text-linear-text",children:k[p]})]}),e.jsx("div",{className:"flex h-10 w-10 items-center justify-center",children:e.jsxs("div",{className:"text-sm font-medium text-linear-text-secondary",children:[Math.round(h),"%"]})})]}),e.jsx("div",{className:"mb-6 mt-4",children:e.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-linear-border",children:e.jsx(I.div,{className:"h-full rounded-full bg-linear-purple",initial:{width:0},animate:{width:`${h}%`},transition:{duration:.3,ease:"easeOut"}})})})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto px-6 pb-safe-bottom",children:e.jsx(S.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-linear-purple border-t-transparent"})}),children:e.jsx(ce,{mode:"wait",children:e.jsx(I.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.25,type:"spring",damping:20},className:"h-full text-linear-text",children:R()},p)})})})}),e.jsx("div",{className:"flex-shrink-0 px-6 pb-6 pt-4",children:e.jsxs("div",{className:"flex gap-3",children:[p>0&&e.jsx(I.button,{onClick:f,className:"h-14 flex-1 rounded-xl border border-linear-border bg-linear-card font-medium text-linear-text-secondary transition-colors hover:bg-linear-border/50 hover:text-linear-text",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:"Back"}),e.jsx(I.button,{onClick:w,disabled:!v,className:j("flex h-14 items-center justify-center gap-2 rounded-xl font-medium transition-all duration-200",p===0?"flex-1":"flex-[2]",v?"bg-linear-text text-linear-bg hover:bg-linear-text/90":"cursor-not-allowed border border-linear-border bg-linear-card text-linear-text-tertiary"),whileTap:v?{scale:.98}:{},children:p===y-1?e.jsxs(e.Fragment,{children:[e.jsx(Pt,{className:"h-5 w-5"}),"Save Entry"]}):e.jsxs(e.Fragment,{children:["Next",e.jsx(Ft,{className:"h-5 w-5"})]})})]})})]})}function La(a){const[t,s]=o.useState(a.initialData?.weight||{value:0,unit:"lbs"}),[r,l]=o.useState(a.initialData?.bodyFat||{value:15}),[i,n]=o.useState(a.initialData?.method||{value:"scale",label:"Digital Scale"}),[c,u]=o.useState(),[m,x]=o.useState(!1),g=async()=>{ve.completeFlow({total_steps:4,completion_time_seconds:Date.now()-ve.startTime,final_weight:`${t.value} ${t.unit}`,final_body_fat:`${r.value}%`,final_method:i.label,had_photo:!!c}),a.onComplete({weight:t,bodyFat:r,method:i,photoUrl:c})};return e.jsx(Sa,{totalSteps:4,initialStep:0,onComplete:g,children:e.jsx($a,{...a,weightData:t,setWeightData:s,bodyFatData:r,setBodyFatData:l,methodData:i,setMethodData:n,photoUrl:c,setPhotoUrl:u,showPhotoCapture:m,setShowPhotoCapture:x})})}function Ua({show:a,onClose:t,onSave:s,units:r,initialWeight:l,initialBodyFat:i}){const{user:n}=ye(),c=async m=>{s({weight:m.weight.value,bodyFatPercentage:m.bodyFat.value,method:{value:m.method.value,label:m.method.label},date:new Date,photoUrl:m.photoUrl}),t()},u={weight:l?{value:l,unit:r==="imperial"?"lbs":"kg"}:void 0,bodyFat:i?{value:i}:void 0,method:void 0};return e.jsx(ce,{children:a&&e.jsx(I.div,{className:"fixed inset-0 z-50 bg-background",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(La,{onComplete:c,onCancel:t,initialData:u})})})}const Ra=S.memo(function({onComplete:t,units:s,className:r}){const[l,i]=o.useState(""),[n,c]=o.useState(""),[u,m]=o.useState("scale"),[x,g]=o.useState(!1),[b,p]=o.useState({}),v=()=>{const h={},y=parseFloat(l),k=parseFloat(n);return!l||isNaN(y)||y<=0?h.weight="Please enter a valid weight":s==="imperial"&&(y<50||y>1e3)?h.weight="Weight must be between 50-1000 lbs":s==="metric"&&(y<20||y>500)&&(h.weight="Weight must be between 20-500 kg"),(!n||isNaN(k)||k<1||k>60)&&(h.bodyFat="Body fat must be between 1-60%"),p(h),Object.keys(h).length===0},w=async h=>{if(h.preventDefault(),!!v()){g(!0);try{t({weight:parseFloat(l),bodyFatPercentage:parseFloat(n),method:u,date:new Date})}catch(y){console.error("Error saving initial weight:",y)}finally{g(!1)}}},f=s==="imperial"?"lbs":"kg",d=s==="imperial"?"e.g., 150":"e.g., 70";return e.jsx("div",{className:j("mx-auto w-full max-w-2xl",r),children:e.jsxs(nt,{className:"border-border bg-background",children:[e.jsxs(it,{className:"pb-6 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-primary/10",children:e.jsx(Ie,{className:"h-8 w-8 text-primary"})}),e.jsx(lt,{className:"text-2xl font-bold text-foreground",children:"Let's get started!"}),e.jsx(ot,{className:"mx-auto max-w-md text-base text-muted-foreground",children:"To begin tracking your body composition journey, we need your current measurements"})]}),e.jsxs(ct,{children:[e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(V,{htmlFor:"weight",className:"flex items-center gap-2 text-base font-medium",children:[e.jsx(Ie,{className:"h-4 w-4 text-primary"}),"Current Weight (",f,")"]}),e.jsx(be,{id:"weight",type:"number",value:l,onChange:h=>i(h.target.value),placeholder:d,className:j("h-12 text-lg",b.weight&&"border-destructive focus:border-destructive"),min:s==="imperial"?"50":"20",max:s==="imperial"?"1000":"500",step:"0.1",autoFocus:!0}),b.weight&&e.jsx("p",{className:"text-sm text-destructive",children:b.weight})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(V,{htmlFor:"bodyFat",className:"flex items-center gap-2 text-base font-medium",children:[e.jsx(Ct,{className:"h-4 w-4 text-primary"}),"Body Fat Percentage"]}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{id:"bodyFat",type:"number",value:n,onChange:h=>c(h.target.value),placeholder:"e.g., 15",className:j("h-12 pr-12 text-lg",b.bodyFat&&"border-destructive focus:border-destructive"),min:"1",max:"60",step:"0.1"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 transform text-muted-foreground",children:"%"})]}),b.bodyFat&&e.jsx("p",{className:"text-sm text-destructive",children:b.bodyFat}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Don't know your body fat? Start with an estimate - you can update it later"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(V,{htmlFor:"method",className:"flex items-center gap-2 text-base font-medium",children:[e.jsx(It,{className:"h-4 w-4 text-primary"}),"Measurement Method"]}),e.jsxs(Ke,{value:u,onValueChange:m,children:[e.jsx(Oe,{className:"h-12 text-lg",children:e.jsx(Ve,{})}),e.jsxs(ze,{children:[e.jsx(K,{value:"scale",children:"Smart Scale"}),e.jsx(K,{value:"dexa",children:"DEXA Scan"}),e.jsx(K,{value:"bodpod",children:"Bod Pod"}),e.jsx(K,{value:"calipers",children:"Body Fat Calipers"}),e.jsx(K,{value:"visual",children:"Visual Estimate"}),e.jsx(K,{value:"other",children:"Other"})]})]})]}),e.jsx(_,{type:"submit",className:"h-12 w-full text-base font-semibold",disabled:x||!l||!n,children:x?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-r-transparent"}),"Setting up your profile..."]}):"Start Tracking"})]}),e.jsx("div",{className:"mt-6 rounded-lg bg-muted/30 p-4",children:e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Tip:"})," Your measurements will be used to calculate FFMI and track progress over time. Don't worry about being precise - consistency is more important than accuracy."]})})]})]})})});function Ae({children:a}){return e.jsx(e.Fragment,{children:a})}const Ha=Dt("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Qe=o.forwardRef(({className:a,variant:t,...s},r)=>e.jsx("div",{ref:r,role:"alert",className:j(Ha({variant:t}),a),...s}));Qe.displayName="Alert";const Ba=o.forwardRef(({className:a,...t},s)=>e.jsx("h5",{ref:s,className:j("mb-1 font-medium leading-none tracking-tight",a),...t}));Ba.displayName="AlertTitle";const et=o.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:j("text-sm [&_p]:leading-relaxed",a),...t}));et.displayName="AlertDescription";function Wa(){const[a,t]=o.useState(!1),[s,r]=o.useState(!1),{user:l}=ye();o.useEffect(()=>{const c=localStorage.getItem("pending_email_confirmation"),u=localStorage.getItem("email_banner_dismissed");c&&!u&&l&&!s&&t(!0)},[l,s]);const i=()=>{t(!1),r(!0),localStorage.setItem("email_banner_dismissed","true")},n=async()=>{console.log("Resending confirmation email...")};return a?e.jsxs(Qe,{className:"mb-4 border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950",children:[e.jsx(Tt,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),e.jsxs(et,{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-blue-800 dark:text-blue-200",children:"Please check your email and click the confirmation link to fully activate your account."})}),e.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:n,className:"h-8 border-blue-300 text-xs text-blue-700 hover:bg-blue-100 dark:border-blue-700 dark:text-blue-300 dark:hover:bg-blue-900",children:"Resend"}),e.jsx(_,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 text-blue-600 hover:bg-blue-100 dark:text-blue-400 dark:hover:bg-blue-900",children:e.jsx(Ye,{className:"h-4 w-4"})})]})]})]}):null}function Ka({metrics:a,className:t}){const[s,r]=o.useState(null),l=o.useMemo(()=>a.filter(n=>n.photoUrl).sort((n,c)=>new Date(c.date).getTime()-new Date(n.date).getTime()),[a]),i=n=>new Intl.DateTimeFormat(void 0,{month:"short",day:"numeric",year:"numeric"}).format(n);return l.length===0?e.jsxs("div",{className:j("text-center py-12",t),children:[e.jsx(Ge,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No progress photos yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Add photos when logging your measurements"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:j("space-y-6",t),children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:l.map((n,c)=>e.jsxs(I.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:c*.05},className:"group relative aspect-[3/4] overflow-hidden rounded-lg bg-secondary cursor-pointer",onClick:()=>r(n),children:[e.jsx("img",{src:n.photoUrl,alt:`Progress photo from ${i(n.date)}`,className:"h-full w-full object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 text-white",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-1",children:[e.jsx(_t,{className:"w-4 h-4"}),i(n.date)]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[n.weight.toFixed(1)," kg"]}),e.jsxs("div",{children:[n.bodyFatPercentage.toFixed(1),"% BF"]})]})]})}),e.jsx("div",{className:"absolute top-2 right-2 bg-black/50 p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Et,{className:"w-4 h-4 text-white"})})]},n.id))}),e.jsx("div",{className:"mt-6 p-4 rounded-lg bg-secondary/20 border border-border",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:[l.length," progress photos"]}),e.jsxs("p",{className:"mt-1",children:["From ",i(l[l.length-1].date)," to ",i(l[0].date)]})]})})]}),e.jsx(we,{open:!!s,onOpenChange:()=>r(null),children:e.jsx(je,{className:"max-w-4xl w-full h-[90vh] p-0",children:s&&e.jsxs("div",{className:"relative h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:i(s.date)}),e.jsxs("div",{className:"flex gap-4 text-sm text-muted-foreground mt-1",children:[e.jsxs("span",{children:[s.weight.toFixed(1)," kg"]}),e.jsxs("span",{children:[s.bodyFatPercentage.toFixed(1),"% BF"]}),s.method&&e.jsx("span",{children:s.method.label})]})]}),e.jsx("button",{onClick:()=>r(null),className:"p-2 rounded-full hover:bg-secondary transition-colors",children:e.jsx(Ye,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 overflow-hidden bg-black/95 flex items-center justify-center",children:e.jsx("img",{src:s.photoUrl,alt:`Progress photo from ${i(s.date)}`,className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"flex items-center justify-center gap-4 p-4 border-t border-border",children:[e.jsx("button",{onClick:()=>{const n=l.findIndex(c=>c.id===s.id);n>0&&r(l[n-1])},disabled:l.findIndex(n=>n.id===s.id)===0,className:"px-4 py-2 rounded-lg bg-secondary hover:bg-secondary/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[l.findIndex(n=>n.id===s.id)+1," / ",l.length]}),e.jsx("button",{onClick:()=>{const n=l.findIndex(c=>c.id===s.id);n<l.length-1&&r(l[n+1])},disabled:l.findIndex(n=>n.id===s.id)===l.length-1,className:"px-4 py-2 rounded-lg bg-secondary hover:bg-secondary/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]})})})]})}const Oa={id:"1",name:"John Doe",email:"john@example.com",gender:"male",birthday:new Date("1990-01-15"),height:180},Va=[{id:"1",userId:"1",date:new Date("2024-01-01"),weight:80,bodyFatPercentage:15,method:"dexa",stepCount:5e3},{id:"2",userId:"1",date:new Date("2024-01-15"),weight:79.5,bodyFatPercentage:14.5,method:"scale",stepCount:6500},{id:"3",userId:"1",date:new Date("2024-02-01"),weight:79,bodyFatPercentage:14,method:"calipers",stepCount:7e3},{id:"4",userId:"1",date:new Date("2024-02-15"),weight:78.5,bodyFatPercentage:13.5,method:"scale",stepCount:8e3}],za={userId:"1",units:"imperial",healthKitSyncEnabled:!1,googleFitSyncEnabled:!1};function Ga(a){return a/2.20462}function fe(a){return a*2.20462}function $e(a){const t=a/2.54,s=Math.floor(t/12),r=Math.round(t%12);return`${s}'${r}"`}function Ya(a){return a/2.54}function qa(a,t){return!a||a<=0||isNaN(a)?0:!t||t<0||t>100||isNaN(t)?a:a*(1-t/100)}function Ja(a,t){if(!a||a<=0||isNaN(a)||!t||t<=0||isNaN(t))return 0;const s=t/100,r=a/(s*s);return isNaN(r)||!isFinite(r)?0:r}function Xa(){const[a,t]=o.useState(Oa),[s,r]=o.useState(Va),[l,i]=o.useState(s.length-1),[n,c]=o.useState(za),u=o.useMemo(()=>[...s].sort((d,h)=>d.date.getTime()-h.date.getTime()),[s]),m=o.useMemo(()=>{const d=u[l];if(!d)return{bodyFatPercentage:0,weight:0,ffmi:0,leanBodyMass:0,stepCount:0,date:new Date};const h=qa(d.weight,d.bodyFatPercentage),y=Ja(h,a.height);return{bodyFatPercentage:d.bodyFatPercentage,weight:d.weight,ffmi:Math.round(y*10)/10,leanBodyMass:Math.round(h*10)/10,stepCount:d.stepCount,date:d.date}},[u,l,a.height]),x=o.useCallback(d=>{const h={...d,id:Date.now().toString(),userId:a.id};r(y=>[...y,h]),i(u.length)},[a.id,u.length]),g=o.useCallback(d=>{console.log("User updates:",d),t(h=>({...h,...d}))},[]),b=o.useCallback(d=>{c(h=>({...h,...d}))},[]),p=o.useCallback(d=>{if(!d||d<=0||isNaN(d))return n.units==="metric"?"0 kg":"0 lbs";if(n.units==="metric")return`${Math.round(d*10)/10} kg`;{const h=fe(d);return`${Math.round(h*10)/10} lbs`}},[n.units]),v=o.useCallback(d=>n.units==="metric"?`${d} cm`:$e(d),[n.units]),w=o.useCallback(d=>{if(!d||d<=0||isNaN(d))return n.units==="metric"?"0 kg":"0 lbs";if(n.units==="metric")return`${Math.round(d*10)/10} kg`;{const h=fe(d);return`${Math.round(h*10)/10} lbs`}},[n.units]),f=o.useCallback(()=>{const d=new Date,h=new Date(a.birthday);let y=d.getFullYear()-h.getFullYear();const k=d.getMonth()-h.getMonth();return(k<0||k===0&&d.getDate()<h.getDate())&&y--,y},[a.birthday]);return{user:a,metrics:u,currentMetrics:m,selectedDateIndex:l,setSelectedDateIndex:i,addMetric:x,updateUser:g,getUserAge:f,settings:n,updateSettings:b,getFormattedWeight:p,getFormattedHeight:v,getFormattedLeanBodyMass:w,utils:{lbsToKg:Ga,kgToLbs:fe,cmToFeet:$e,cmToInches:Ya}}}function Le(a){if(!a)return 30;const t=new Date(a),s=new Date;let r=s.getFullYear()-t.getFullYear();const l=s.getMonth()-t.getMonth();return(l<0||l===0&&s.getDate()<t.getDate())&&r--,Math.max(18,Math.min(65,r))}S.lazy(()=>Q(()=>import("./AvatarSilhouette-jdYYgwoS.js"),__vite__mapDeps([23,1,2,3,4,5,6,7,9,10,11,12,13,14,15,16,17])).then(a=>({default:a.AvatarSilhouette})));const ge=()=>e.jsx("div",{className:"flex h-full min-h-[400px] items-center justify-center bg-muted/30 md:min-h-0",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading 3D avatar..."})]})}),Za=()=>{console.log("Dashboard: Component rendering");const a=at(),t=vt();Xa();const s=Ue(),{user:r,metrics:l,currentMetrics:i,selectedDateIndex:n,setSelectedDateIndex:c,addMetric:u,getUserAge:m,getFormattedWeight:x,getFormattedHeight:g,getFormattedLeanBodyMass:b,settings:p,utils:v}=t,w=t.loading,[f,d]=o.useState(0),[h,y]=o.useState(!1),[k,F]=o.useState(!1),[D,T]=o.useState(!1),[R,M]=o.useState(null),[P,A]=o.useState(!1),[H,Pe]=o.useState(!1),se=C=>{d(C)},de=o.useCallback(()=>{n<l.length-1?c(n+1):a("/settings")},[n,l.length,c,a]),re=o.useCallback(()=>{n>0&&c(n-1)},[n,c]);$t({onSwipeLeft:de,onSwipeRight:re,threshold:100}),S.useEffect(()=>{if(!P)if(le()&&s.isAvailable){(async()=>{try{if(s.isAuthorized){const B=await s.getHealthData();B&&B.weight&&(M(B),console.log("HealthKit weight data found:",B.weight))}}catch(B){console.warn("Error checking HealthKit data:",B)}finally{A(!0)}})();const U=setTimeout(()=>{P||(console.warn("HealthKit check timed out, proceeding without HealthKit data"),A(!0))},3e3);return()=>clearTimeout(U)}else A(!0)},[P]);const q=C=>{let U=C.weight;p.units==="imperial"&&(U=v.lbsToKg(C.weight)),u({...C,weight:U})},ue=l.length>0&&l.some(C=>C.weight>0),he=R&&R.weight>0,N=ue||he;return S.useEffect(()=>{!w&&r&&p&&P&&!N&&!D&&T(!0)},[w,r,p,P,N,D]),w||!r||!p?e.jsx("div",{className:"flex min-h-svh items-center justify-center bg-linear-bg font-inter",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-2 border-linear-purple border-t-transparent"}),e.jsx("p",{className:"text-linear-text-secondary",children:"Setting up your dashboard..."})]})}):D&&!N?e.jsx(Ae,{children:e.jsx("div",{className:"flex min-h-svh items-center justify-center bg-linear-bg p-6 font-inter",children:e.jsx(Ra,{onComplete:C=>{q(C),T(!1)},units:p.units})})}):e.jsx(Ae,{children:e.jsxs("div",{className:"flex h-svh flex-col overflow-hidden bg-linear-bg text-linear-text font-inter md:min-h-svh md:overflow-auto",children:[e.jsx("div",{className:"px-4 pt-4 md:px-6",children:e.jsx(Wa,{})}),e.jsxs("div",{className:"hidden items-center justify-between border-b border-linear-border px-6 py-4 md:flex",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-xl font-semibold tracking-tight text-linear-text",children:"LogYourBody"}),e.jsx(At,{})]}),e.jsxs("div",{className:"flex gap-3",children:[le()&&e.jsx(_,{size:"icon",variant:"ghost",onMouseEnter:()=>G("/healthkit-test"),onFocus:()=>G("/healthkit-test"),onClick:()=>a("/healthkit-test"),className:"text-linear-text-secondary transition-colors hover:bg-linear-border/50 hover:text-linear-text",title:"HealthKit Testing (Development)",children:e.jsx(Mt,{className:"h-4 w-4"})}),e.jsx(_,{size:"icon",variant:"ghost",onClick:()=>{N?F(!0):T(!0)},className:"h-10 w-10 text-linear-text-secondary transition-colors hover:bg-linear-border/50 hover:text-linear-text",children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx(_,{size:"icon",variant:"ghost",onMouseEnter:()=>G("/settings"),onFocus:()=>G("/settings"),onClick:()=>a("/settings"),className:"h-10 w-10 text-linear-text-secondary transition-colors hover:bg-linear-border/50 hover:text-linear-text",children:e.jsx(Te,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex min-h-0 flex-1 flex-col md:flex-row",children:[e.jsxs("div",{className:"relative min-h-0 flex-[1.5] md:w-2/3 md:flex-1",children:[e.jsx(ya,{tabs:wa(e.jsx(o.Suspense,{fallback:e.jsx(ge,{}),children:e.jsx(Me,{gender:r.gender,bodyFatPercentage:i.bodyFatPercentage,showPhoto:!1,className:"h-full w-full",weight:i.weight,height:r.height,age:Le(r.birthday)})}),e.jsx(o.Suspense,{fallback:e.jsx(ge,{}),children:e.jsx(Me,{gender:r.gender,bodyFatPercentage:i.bodyFatPercentage,showPhoto:!0,profileImage:r.profileImage,className:"h-full w-full",weight:i.weight,height:r.height,age:Le(r.birthday)})}),e.jsx(o.Suspense,{fallback:e.jsx(ge,{}),children:e.jsx(Ka,{metrics:l,className:"h-full w-full p-4 overflow-y-auto"})})),defaultIndex:f,onTabChange:se,swipeEnabled:!0,className:"h-full w-full"}),e.jsxs("div",{className:"top-safe-top absolute right-4 z-20 flex gap-3 md:hidden",children:[e.jsx(_,{size:"icon",variant:"ghost",onClick:()=>{N?F(!0):T(!0)},className:"h-10 w-10 bg-linear-bg/80 text-linear-text-secondary shadow-lg backdrop-blur-sm transition-colors hover:bg-linear-card hover:text-linear-text",children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx(_,{size:"icon",variant:"ghost",onMouseEnter:()=>G("/settings"),onFocus:()=>G("/settings"),onClick:()=>a("/settings"),className:"h-10 w-10 bg-linear-bg/80 text-linear-text-secondary shadow-lg backdrop-blur-sm transition-colors hover:bg-linear-card hover:text-linear-text",children:e.jsx(Te,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"min-h-0 flex-[0.8] border-linear-border md:w-1/3 md:flex-1 md:border-l",children:e.jsx(ma,{metrics:i,user:r,userAge:m(),formattedWeight:x(i.weight),formattedHeight:g(r.height),formattedLeanBodyMass:b(i.leanBodyMass)})})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(xa,{metrics:l,selectedIndex:n,onIndexChange:c})}),e.jsx(Na,{open:h,onOpenChange:y,onSave:q,units:p.units}),e.jsx(Ua,{show:k,onSave:q,onClose:()=>F(!1),units:p.units,initialWeight:i.weight>0?p.units==="imperial"?v.kgToLbs(i.weight):i.weight:void 0,initialBodyFat:i.bodyFatPercentage})]})})},xs=Object.freeze(Object.defineProperty({__proto__:null,default:Za},Symbol.toStringTag,{value:"Module"}));export{xs as D,_e as L,ms as a,Ee as b,ka as u,ve as w};
