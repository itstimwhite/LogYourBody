const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/WeightStep-DKWJ3O9j.js","assets/ui-vendor-QE-oobKj.js","assets/react-vendor-ClhmtWht.js","assets/index-CyPnvWQK.js","assets/data-vendor-DLfSSb0Z.js","assets/utils-vendor-BSj6XY88.js","assets/analytics-vendor-CXgENQ1a.js","assets/index-D1-nO6UG.css","assets/weight-logging-BIZ1MV3J.js","assets/use-supabase-body-metrics-B5fccTwE.js","assets/input-BuoCXOhS.js","assets/label-DALfSSFr.js","assets/VersionDisplay-8Gv_tqWh.js","assets/use-swipe-navigation-eIglpj1B.js","assets/BodyFatStep-V5sLE62T.js","assets/MethodStep-BfLiJLSE.js","assets/ReviewStep-DZNmaqCI.js","assets/AvatarSilhouette-BjiMYIz8.js"])))=>i.map(i=>d[i]);
import{_ as ue}from"./data-vendor-DLfSSb0Z.js";import{j as r,e as tt,f as Kt,g as Gt,h as zt,i as qt,k as Yt,l as at,I as Xt,m as Jt,n as nt,o as Zt,p as rt,q as Qt,r as ea,s as st,t as it,L as ot,u as lt}from"./ui-vendor-QE-oobKj.js";import{R as N,a as l,u as ta}from"./react-vendor-ClhmtWht.js";import{m as T,g as w,A as ve,k as ct,i as be,B as _,f as aa,H as we,I as je,C as na,b as ra,c as sa,e as ia,d as oa,u as la}from"./index-CyPnvWQK.js";import{D as ca,a as da,b as ua,c as fa,u as ma}from"./use-supabase-body-metrics-B5fccTwE.js";import{I as ke}from"./input-BuoCXOhS.js";import{L as z}from"./label-DALfSSFr.js";import{p as dt,n as ut,q as ha,L as pa,d as ga,o as ba,A as xa,S as Ue,r as va,e as ya,a as wa,s as ja,X as Na,H as Ea,P as Ve,u as Ke}from"./utils-vendor-BSj6XY88.js";import{V as $a}from"./VersionDisplay-8Gv_tqWh.js";import{u as Sa}from"./use-swipe-navigation-eIglpj1B.js";const ka={animation:{spring:{type:"spring",damping:20,stiffness:300},fadeIn:{duration:.25,ease:"easeOut"},slideIn:{duration:.3,ease:"easeInOut"}}},K=e=>ka.animation[e],D={profileValue:"text-2xl md:text-3xl lg:text-4xl font-semibold leading-tight text-foreground",profileLabel:"text-xs md:text-sm font-medium uppercase opacity-70 tracking-wider text-muted-foreground",profileUnit:"text-xl md:text-2xl font-medium opacity-80 text-muted-foreground",attributeLabel:"text-[10px] md:text-xs font-medium uppercase opacity-70 tracking-wider text-muted-foreground",attributeValue:"text-xs md:text-sm font-semibold text-foreground",timelineLabel:"text-[10px] md:text-xs font-medium opacity-70 text-muted-foreground",timelineValue:"text-sm md:text-base font-semibold text-foreground",statsGrid:"grid grid-cols-2 gap-3 md:flex md:flex-col md:gap-4",attributeRow:"grid grid-cols-3 gap-3 min-h-[40px] md:min-h-[48px]",avatarContainer:"relative h-[50vh] max-h-[400px] md:h-full w-full",safeArea:"pb-[env(safe-area-inset-bottom)]"},Fa=N.memo(function({metrics:t,formattedWeight:a,formattedLeanBodyMass:n,className:s}){const i=K("fadeIn"),o=[{value:(t.bodyFatPercentage||0).toFixed(1),unit:"%",label:"Body Fat",accessibilityLabel:`Body fat percentage: ${(t.bodyFatPercentage||0).toFixed(1)} percent`},{value:a,label:"Weight",accessibilityLabel:`Weight: ${a}`},{value:isNaN(t.ffmi)||!isFinite(t.ffmi)?"--":t.ffmi.toFixed(1),label:"FFMI",accessibilityLabel:`Fat Free Mass Index: ${isNaN(t.ffmi)||!isFinite(t.ffmi)?"not available":t.ffmi.toFixed(1)}`},{value:n,label:"Lean Body Mass",accessibilityLabel:`Lean body mass: ${n}`}];return r.jsx(T.div,{className:w(D.statsGrid,"mb-6 md:mb-8",s),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:i,children:o.map((c,d)=>r.jsxs(T.div,{className:"min-w-0 flex-shrink-0 text-center md:text-left",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{...i,delay:d*.05},children:[r.jsxs("div",{className:"flex items-baseline justify-center gap-1 md:justify-start","aria-label":c.accessibilityLabel,children:[r.jsx("span",{className:w(D.profileValue,"font-inter tracking-tight"),children:c.value}),c.unit&&r.jsx("span",{className:D.profileUnit,children:c.unit})]}),r.jsx("div",{className:w(D.profileLabel,"mt-1"),children:c.label})]},c.label))})}),Ta=(e,t)=>{N.useEffect(()=>{const a=`Stats updated: Body fat ${(e.bodyFatPercentage||0).toFixed(1)} percent, Weight ${t}, FFMI ${e.ffmi}`,n=document.createElement("div");n.setAttribute("aria-live","polite"),n.setAttribute("aria-atomic","true"),n.style.position="absolute",n.style.left="-10000px",n.style.width="1px",n.style.height="1px",n.style.overflow="hidden",document.body.appendChild(n),setTimeout(()=>{n.textContent=a,setTimeout(()=>{document.body.removeChild(n)},1e3)},100)},[e.bodyFatPercentage,t,e.ffmi])},Pa=e=>{if(!e)return 0;try{const t=typeof e=="string"?new Date(e):e;if(!t||isNaN(t.getTime()))return console.warn("Invalid birth date provided:",e),0;const s=(new Date().getTime()-t.getTime())/(1e3*60*60*24);return Math.floor(s/365.25)}catch(t){return console.error("Error calculating age:",t,"birthDate:",e),0}},La=N.memo(function({user:t,userAge:a,formattedHeight:n,className:s}){const i=K("fadeIn"),o=t.birthDate?Pa(t.birthDate):0,c=o>0?o:a,d=c>0,f=[{label:"Age",value:d?c.toString():"",accessibilityLabel:d?`Age: ${c} years old`:"Age not available",hidden:!d},{label:"Height",value:n,accessibilityLabel:`Height: ${n}`},{label:"Sex",value:t.gender?t.gender.charAt(0).toUpperCase()+t.gender.slice(1):"Not specified",accessibilityLabel:`Sex: ${t.gender||"Not specified"}`}];return r.jsx(T.div,{className:w(D.attributeRow,"pt-3 md:pt-6",s),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{...i,delay:.3},children:f.map((m,h)=>r.jsxs(T.div,{className:w("flex flex-col justify-center text-center md:text-left",m.hidden&&"pointer-events-none opacity-0"),initial:{opacity:0,scale:.95},animate:{opacity:m.hidden?0:1,scale:1},transition:{...i,delay:.4+h*.05},"aria-hidden":m.hidden,children:[r.jsx("div",{className:w(D.attributeLabel,"mb-1"),children:m.label}),r.jsx("div",{className:D.attributeValue,"aria-label":m.accessibilityLabel,children:m.value||"-"})]},m.label))})}),Da=(e,t,a)=>{N.useEffect(()=>{const n=[];if(t>0&&n.push(`${t} years old`),a&&n.push(`Height ${a}`),e.gender&&n.push(`${e.gender}`),n.length>0){const s=`User profile: ${n.join(", ")}`,i=document.createElement("div");i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),i.style.position="absolute",i.style.left="-10000px",i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",document.body.appendChild(i),setTimeout(()=>{i.textContent=s,setTimeout(()=>{document.body.removeChild(i)},1e3)},100)}},[e.gender,t,a])},Ia=N.memo(function({metrics:t,user:a,userAge:n,formattedWeight:s,formattedHeight:i,formattedLeanBodyMass:o,className:c}){const d=K("fadeIn");return Ta(t,s),Da(a,n,i),N.useEffect(()=>{typeof window<"u"&&window.gtag&&window.gtag("event","profile_viewed",{event_category:"Profile",event_label:"Profile Panel",custom_parameters:{user_has_name:!!a.name,user_has_height:!!i,user_has_age:n>0,body_fat_percentage:t.bodyFatPercentage,ffmi:t.ffmi}})},[t,a,n,i]),r.jsxs(T.div,{className:w("flex h-full w-full flex-col justify-center p-4 md:p-6","bg-background/95 backdrop-blur-sm",c),initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:d,role:"region","aria-label":"User profile and body metrics",children:[a.name&&r.jsx(T.div,{className:"mb-6 md:mb-8",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{...d,delay:.1},children:r.jsx("h1",{className:"text-base font-semibold tracking-tight text-foreground md:text-lg",children:a.name})}),r.jsx(Fa,{metrics:t,formattedWeight:s,formattedLeanBodyMass:o}),r.jsx("div",{className:"mt-auto border-t border-border/30",children:r.jsx(La,{user:a,userAge:n,formattedHeight:i})})]})}),Ae=l.forwardRef(({className:e,...t},a)=>r.jsxs(tt,{ref:a,className:w("relative flex w-full touch-none select-none items-center",e),...t,children:[r.jsx(Kt,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:r.jsx(Gt,{className:"absolute h-full bg-primary"})}),r.jsx(zt,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Ae.displayName=tt.displayName;const Aa=N.memo(function({metrics:t,selectedIndex:a,onIndexChange:n,className:s}){const i=K("fadeIn"),[o,c]=l.useState({selectedIndex:a,isDragging:!1,announcement:""});l.useEffect(()=>{c(b=>({...b,selectedIndex:a}))},[a]);const d=l.useCallback(b=>b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),[]),f=l.useCallback(b=>b.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),[]),m=l.useCallback(b=>{const j=b[0];c(S=>({...S,selectedIndex:j})),n(j);const $=t[j];if($){const S=`Entry ${j+1} of ${t.length}, ${f($.date)}`;c(F=>({...F,announcement:S}))}typeof window<"u"&&window.gtag&&window.gtag("event","timeline_changed",{event_category:"Profile",event_label:"Timeline Navigation",value:j,custom_parameters:{total_entries:t.length,entry_date:$?d($.date):null}})},[t,n,d,f]),h=l.useCallback(()=>{c(b=>({...b,isDragging:!0}))},[]),x=l.useCallback(()=>{c(b=>({...b,isDragging:!1}))},[]),p=l.useMemo(()=>t[o.selectedIndex],[t,o.selectedIndex]);if(t.length===0)return null;const v=p?.date,y=t[0]?.date,g=t[t.length-1]?.date,u={value:[o.selectedIndex],onValueChange:m,onPointerDown:h,onPointerUp:x,max:t.length-1,min:0,step:1,"aria-label":`Timeline slider. Entry ${o.selectedIndex+1} of ${t.length}`,"aria-valuetext":v?`${f(v)}, entry ${o.selectedIndex+1} of ${t.length}`:void 0,"aria-describedby":"timeline-description"};return r.jsxs(T.div,{className:w("w-full border-t border-border/50 bg-background shadow-sm",D.safeArea,s),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:i,children:[r.jsx("div",{className:"px-4 py-3 md:px-6 md:py-6",children:r.jsxs("div",{className:"space-y-3 md:space-y-4",children:[r.jsxs(T.div,{className:"text-center",layout:!0,children:[r.jsx("div",{className:w(D.timelineValue,"tracking-tight"),"aria-live":"polite","aria-atomic":"true",children:v?d(v):"No date"}),r.jsxs("div",{className:w(D.timelineLabel,"mt-1"),id:"timeline-description",children:["Entry ",o.selectedIndex+1," of ",t.length]})]}),r.jsx("div",{className:"px-2 md:px-4",children:r.jsxs("div",{className:"relative",children:[r.jsx(Ae,{...u,className:w("timeline-slider w-full","[&_[role=slider]]:h-6 [&_[role=slider]]:w-6","[&_[role=slider]]:border-2 [&_[role=slider]]:border-background","[&_[role=slider]]:shadow-lg [&_[role=slider]]:focus:shadow-xl","[&_.relative]:h-2")}),t.length>1&&r.jsxs("div",{className:"pointer-events-none absolute inset-x-0 top-1/2 flex -translate-y-1/2 transform justify-between",children:[r.jsx("div",{className:"h-1 w-1 rounded-full bg-muted-foreground/50"}),r.jsx("div",{className:"h-1 w-1 rounded-full bg-muted-foreground/50"})]})]})}),t.length>1&&y&&g&&r.jsxs(T.div,{className:"flex justify-between px-2 md:px-4",initial:{opacity:0},animate:{opacity:1},transition:{...i,delay:.2},children:[r.jsx("span",{className:w(D.timelineLabel,"text-left"),"aria-label":`Earliest entry: ${f(y)}`,children:d(y)}),r.jsx("span",{className:w(D.timelineLabel,"text-right"),"aria-label":`Latest entry: ${f(g)}`,children:d(g)})]})]})}),r.jsx("div",{className:"sr-only","aria-live":"polite","aria-atomic":"true",children:o.announcement})]})}),Ge=N.memo(function({src:t,alt:a,placeholder:n="/placeholder.svg",className:s,fallback:i,...o}){const[c,d]=l.useState(!1),[f,m]=l.useState(!1),[h,x]=l.useState(!1),p=l.useRef(null);l.useEffect(()=>{const g=new IntersectionObserver(([u])=>{u.isIntersecting&&(m(!0),g.disconnect())},{threshold:.1});return p.current&&g.observe(p.current),()=>g.disconnect()},[]);const v=()=>{d(!0),x(!1)},y=()=>{x(!0),d(!1)};return h&&i?r.jsx(r.Fragment,{children:i}):r.jsxs("div",{ref:p,className:w("relative overflow-hidden",s),children:[!c&&r.jsx("img",{src:n,alt:"",className:w("absolute inset-0 h-full w-full object-cover transition-opacity duration-300",c?"opacity-0":"opacity-100"),"aria-hidden":"true"}),!c&&f&&r.jsx("div",{className:"absolute inset-0 animate-pulse bg-gradient-to-r from-transparent via-white/20 to-transparent"}),f&&r.jsx("img",{src:t,alt:a,onLoad:v,onError:y,className:w("h-full w-full object-cover transition-opacity duration-300",c?"opacity-100":"opacity-0"),loading:"lazy",...o})]})});function Ca(e){return Math.max(5,Math.min(50,Math.round(e/5)*5))}function Ma(e){const{bodyFat:t=20,gender:a="male"}=e;return{bodyFat:Ca(t),sex:a==="female"?"f":"m"}}function _a(e){return`${e.sex}_bf${e.bodyFat}.svg`}function ft(e){return`/avatars/${_a(e)}`}function Ha(e){const t=Ma(e);return ft(t)}function Ra(e){const t={bodyFat:20,sex:e.sex};return ft(t)}const ze=N.memo(function({gender:t,bodyFatPercentage:a,showPhoto:n,profileImage:s,className:i,weight:o=70,height:c=170,age:d=30}){K("fadeIn");const f=K("spring"),[m,h]=l.useState(!1),x=l.useMemo(()=>Ha({bodyFat:a,gender:t}),[o,c,a,d,t]),p=l.useMemo(()=>Ra({sex:t==="female"?"f":"m"}),[a,t]),v=()=>{h(!0)},y=()=>{h(!1)};return r.jsx("div",{className:w(D.avatarContainer,"overflow-hidden",i),children:r.jsx("div",{className:"flex h-full items-center justify-center p-4",children:r.jsx(ve,{mode:"wait",children:n&&s?r.jsx(T.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:f,className:"max-h-full max-w-full",children:r.jsx(Ge,{src:s,alt:"Profile photo showing current body composition",className:"max-h-full max-w-full rounded-lg object-contain shadow-lg"})},"photo"):r.jsx(T.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:f,className:"flex h-64 w-40 items-center justify-center md:h-80 md:w-48",children:r.jsx(Ge,{src:m?p:x,alt:`${t} body composition wireframe showing ${(a||0).toFixed(1)}% body fat`,className:"h-full w-full object-contain",onError:v,onLoad:y,style:{filter:"drop-shadow(0 0 8px rgba(255, 255, 255, 0.1))"}})},"avatar")})})})}),mt=typeof document<"u"?N.useLayoutEffect:()=>{};function Oa(e){const t=l.useRef(null);return mt(()=>{t.current=e},[e]),l.useCallback((...a)=>{const n=t.current;return n?.(...a)},[])}const G=e=>{var t;return(t=e?.ownerDocument)!==null&&t!==void 0?t:document},q=e=>e&&"window"in e&&e.window===e?e:G(e).defaultView||window;function Wa(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&typeof e.nodeType=="number"}function Ba(e){return Wa(e)&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in e}let Ua=!1;function Ce(){return Ua}function ht(e,t){if(!Ce())return t&&e?e.contains(t):!1;if(!e||!t)return!1;let a=t;for(;a!==null;){if(a===e)return!0;a.tagName==="SLOT"&&a.assignedSlot?a=a.assignedSlot.parentNode:Ba(a)?a=a.host:a=a.parentNode}return!1}const Fe=(e=document)=>{var t;if(!Ce())return e.activeElement;let a=e.activeElement;for(;a&&"shadowRoot"in a&&(!((t=a.shadowRoot)===null||t===void 0)&&t.activeElement);)a=a.shadowRoot.activeElement;return a};function pt(e){return Ce()&&e.target.shadowRoot&&e.composedPath?e.composedPath()[0]:e.target}function Va(e){var t;return typeof window>"u"||window.navigator==null?!1:((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.brands.some(a=>e.test(a.brand)))||e.test(window.navigator.userAgent)}function Ka(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function gt(e){let t=null;return()=>(t==null&&(t=e()),t)}const Ga=gt(function(){return Ka(/^Mac/i)}),za=gt(function(){return Va(/Android/i)});function bt(){let e=l.useRef(new Map),t=l.useCallback((s,i,o,c)=>{let d=c?.once?(...f)=>{e.current.delete(o),o(...f)}:o;e.current.set(o,{type:i,eventTarget:s,fn:d,options:c}),s.addEventListener(i,d,c)},[]),a=l.useCallback((s,i,o,c)=>{var d;let f=((d=e.current.get(o))===null||d===void 0?void 0:d.fn)||o;s.removeEventListener(i,f,c),e.current.delete(o)},[]),n=l.useCallback(()=>{e.current.forEach((s,i)=>{a(s.eventTarget,s.type,i,s.options)})},[a]);return l.useEffect(()=>n,[n]),{addGlobalListener:t,removeGlobalListener:a,removeAllGlobalListeners:n}}function qa(e){return e.mozInputSource===0&&e.isTrusted?!0:za()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function xt(e){let t=e;return t.nativeEvent=e,t.isDefaultPrevented=()=>t.defaultPrevented,t.isPropagationStopped=()=>t.cancelBubble,t.persist=()=>{},t}function Ya(e,t){Object.defineProperty(e,"target",{value:t}),Object.defineProperty(e,"currentTarget",{value:t})}function vt(e){let t=l.useRef({isFocused:!1,observer:null});mt(()=>{const n=t.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]);let a=Oa(n=>{e?.(n)});return l.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){t.current.isFocused=!0;let s=n.target,i=o=>{if(t.current.isFocused=!1,s.disabled){let c=xt(o);a(c)}t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};s.addEventListener("focusout",i,{once:!0}),t.current.observer=new MutationObserver(()=>{if(t.current.isFocused&&s.disabled){var o;(o=t.current.observer)===null||o===void 0||o.disconnect();let c=s===document.activeElement?null:document.activeElement;s.dispatchEvent(new FocusEvent("blur",{relatedTarget:c})),s.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:c}))}}),t.current.observer.observe(s,{attributes:!0,attributeFilter:["disabled"]})}},[a])}let Xa=!1,fe=null,Te=new Set,de=new Map,X=!1,Pe=!1;const Ja={Tab:!0,Escape:!0};function Me(e,t){for(let a of Te)a(e,t)}function Za(e){return!(e.metaKey||!Ga()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function xe(e){X=!0,Za(e)&&(fe="keyboard",Me("keyboard",e))}function te(e){fe="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(X=!0,Me("pointer",e))}function yt(e){qa(e)&&(X=!0,fe="virtual")}function wt(e){e.target===window||e.target===document||Xa||!e.isTrusted||(!X&&!Pe&&(fe="virtual",Me("virtual",e)),X=!1,Pe=!1)}function jt(){X=!1,Pe=!0}function Le(e){if(typeof window>"u"||typeof document>"u"||de.get(q(e)))return;const t=q(e),a=G(e);let n=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){X=!0,n.apply(this,arguments)},a.addEventListener("keydown",xe,!0),a.addEventListener("keyup",xe,!0),a.addEventListener("click",yt,!0),t.addEventListener("focus",wt,!0),t.addEventListener("blur",jt,!1),typeof PointerEvent<"u"&&(a.addEventListener("pointerdown",te,!0),a.addEventListener("pointermove",te,!0),a.addEventListener("pointerup",te,!0)),t.addEventListener("beforeunload",()=>{Nt(e)},{once:!0}),de.set(t,{focus:n})}const Nt=(e,t)=>{const a=q(e),n=G(e);t&&n.removeEventListener("DOMContentLoaded",t),de.has(a)&&(a.HTMLElement.prototype.focus=de.get(a).focus,n.removeEventListener("keydown",xe,!0),n.removeEventListener("keyup",xe,!0),n.removeEventListener("click",yt,!0),a.removeEventListener("focus",wt,!0),a.removeEventListener("blur",jt,!1),typeof PointerEvent<"u"&&(n.removeEventListener("pointerdown",te,!0),n.removeEventListener("pointermove",te,!0),n.removeEventListener("pointerup",te,!0)),de.delete(a))};function Qa(e){const t=G(e);let a;return t.readyState!=="loading"?Le(e):(a=()=>{Le(e)},t.addEventListener("DOMContentLoaded",a)),()=>Nt(e,a)}typeof document<"u"&&Qa();function Et(){return fe!=="pointer"}const en=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function tn(e,t,a){let n=G(a?.target);const s=typeof window<"u"?q(a?.target).HTMLInputElement:HTMLInputElement,i=typeof window<"u"?q(a?.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?q(a?.target).HTMLElement:HTMLElement,c=typeof window<"u"?q(a?.target).KeyboardEvent:KeyboardEvent;return e=e||n.activeElement instanceof s&&!en.has(n.activeElement.type)||n.activeElement instanceof i||n.activeElement instanceof o&&n.activeElement.isContentEditable,!(e&&t==="keyboard"&&a instanceof c&&!Ja[a.key])}function an(e,t,a){Le(),l.useEffect(()=>{let n=(s,i)=>{tn(!!a?.isTextInput,s,i)&&e(Et())};return Te.add(n),()=>{Te.delete(n)}},t)}function nn(e){let{isDisabled:t,onFocus:a,onBlur:n,onFocusChange:s}=e;const i=l.useCallback(d=>{if(d.target===d.currentTarget)return n&&n(d),s&&s(!1),!0},[n,s]),o=vt(i),c=l.useCallback(d=>{const f=G(d.target),m=f?Fe(f):Fe();d.target===d.currentTarget&&m===pt(d.nativeEvent)&&(a&&a(d),s&&s(!0),o(d))},[s,a,o]);return{focusProps:{onFocus:!t&&(a||s||n)?c:void 0,onBlur:!t&&(n||s)?i:void 0}}}function rn(e){let{isDisabled:t,onBlurWithin:a,onFocusWithin:n,onFocusWithinChange:s}=e,i=l.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:c}=bt(),d=l.useCallback(h=>{h.currentTarget.contains(h.target)&&i.current.isFocusWithin&&!h.currentTarget.contains(h.relatedTarget)&&(i.current.isFocusWithin=!1,c(),a&&a(h),s&&s(!1))},[a,s,i,c]),f=vt(d),m=l.useCallback(h=>{if(!h.currentTarget.contains(h.target))return;const x=G(h.target),p=Fe(x);if(!i.current.isFocusWithin&&p===pt(h.nativeEvent)){n&&n(h),s&&s(!0),i.current.isFocusWithin=!0,f(h);let v=h.currentTarget;o(x,"focus",y=>{if(i.current.isFocusWithin&&!ht(v,y.target)){let g=new x.defaultView.FocusEvent("blur",{relatedTarget:y.target});Ya(g,v);let u=xt(g);d(u)}},{capture:!0})}},[n,s,f,o,d]);return t?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:m,onBlur:d}}}let De=!1,Ne=0;function sn(){De=!0,setTimeout(()=>{De=!1},50)}function qe(e){e.pointerType==="touch"&&sn()}function on(){if(!(typeof document>"u"))return typeof PointerEvent<"u"&&document.addEventListener("pointerup",qe),Ne++,()=>{Ne--,!(Ne>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",qe)}}function ln(e){let{onHoverStart:t,onHoverChange:a,onHoverEnd:n,isDisabled:s}=e,[i,o]=l.useState(!1),c=l.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;l.useEffect(on,[]);let{addGlobalListener:d,removeAllGlobalListeners:f}=bt(),{hoverProps:m,triggerHoverEnd:h}=l.useMemo(()=>{let x=(y,g)=>{if(c.pointerType=g,s||g==="touch"||c.isHovered||!y.currentTarget.contains(y.target))return;c.isHovered=!0;let u=y.currentTarget;c.target=u,d(G(y.target),"pointerover",b=>{c.isHovered&&c.target&&!ht(c.target,b.target)&&p(b,b.pointerType)},{capture:!0}),t&&t({type:"hoverstart",target:u,pointerType:g}),a&&a(!0),o(!0)},p=(y,g)=>{let u=c.target;c.pointerType="",c.target=null,!(g==="touch"||!c.isHovered||!u)&&(c.isHovered=!1,f(),n&&n({type:"hoverend",target:u,pointerType:g}),a&&a(!1),o(!1))},v={};return typeof PointerEvent<"u"&&(v.onPointerEnter=y=>{De&&y.pointerType==="mouse"||x(y,y.pointerType)},v.onPointerLeave=y=>{!s&&y.currentTarget.contains(y.target)&&p(y,y.pointerType)}),{hoverProps:v,triggerHoverEnd:p}},[t,a,n,s,c,d,f]);return l.useEffect(()=>{s&&h({currentTarget:c.target},c.pointerType)},[s]),{hoverProps:m,isHovered:i}}function $t(e={}){let{autoFocus:t=!1,isTextInput:a,within:n}=e,s=l.useRef({isFocused:!1,isFocusVisible:t||Et()}),[i,o]=l.useState(!1),[c,d]=l.useState(()=>s.current.isFocused&&s.current.isFocusVisible),f=l.useCallback(()=>d(s.current.isFocused&&s.current.isFocusVisible),[]),m=l.useCallback(p=>{s.current.isFocused=p,o(p),f()},[f]);an(p=>{s.current.isFocusVisible=p,f()},[],{isTextInput:a});let{focusProps:h}=nn({isDisabled:n,onFocusChange:m}),{focusWithinProps:x}=rn({isDisabled:!n,onFocusWithinChange:m});return{isFocused:i,isFocusVisible:c,focusProps:n?x:h}}var cn=Object.defineProperty,dn=(e,t,a)=>t in e?cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,Ee=(e,t,a)=>(dn(e,typeof t!="symbol"?t+"":t,a),a);let un=class{constructor(){Ee(this,"current",this.detect()),Ee(this,"handoffState","pending"),Ee(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},St=new un;function kt(e){var t,a;return St.isServer?null:e?"ownerDocument"in e?e.ownerDocument:"current"in e?(a=(t=e.current)==null?void 0:t.ownerDocument)!=null?a:document:null:document}function Ft(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function Tt(){let e=[],t={addEventListener(a,n,s,i){return a.addEventListener(n,s,i),t.add(()=>a.removeEventListener(n,s,i))},requestAnimationFrame(...a){let n=requestAnimationFrame(...a);return t.add(()=>cancelAnimationFrame(n))},nextFrame(...a){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...a))},setTimeout(...a){let n=setTimeout(...a);return t.add(()=>clearTimeout(n))},microTask(...a){let n={current:!0};return Ft(()=>{n.current&&a[0]()}),t.add(()=>{n.current=!1})},style(a,n,s){let i=a.style.getPropertyValue(n);return Object.assign(a.style,{[n]:s}),this.add(()=>{Object.assign(a.style,{[n]:i})})},group(a){let n=Tt();return a(n),this.add(()=>n.dispose())},add(a){return e.includes(a)||e.push(a),()=>{let n=e.indexOf(a);if(n>=0)for(let s of e.splice(n,1))s()}},dispose(){for(let a of e.splice(0))a()}};return t}function fn(){let[e]=l.useState(Tt);return l.useEffect(()=>()=>e.dispose(),[e]),e}let ae=(e,t)=>{St.isServer?l.useEffect(e,t):l.useLayoutEffect(e,t)};function le(e){let t=l.useRef(e);return ae(()=>{t.current=e},[e]),t}let H=function(e){let t=le(e);return N.useCallback((...a)=>t.current(...a),[t])};function mn(e){let t=e.width/2,a=e.height/2;return{top:e.clientY-a,right:e.clientX+t,bottom:e.clientY+a,left:e.clientX-t}}function hn(e,t){return!(!e||!t||e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}function pn({disabled:e=!1}={}){let t=l.useRef(null),[a,n]=l.useState(!1),s=fn(),i=H(()=>{t.current=null,n(!1),s.dispose()}),o=H(c=>{if(s.dispose(),t.current===null){t.current=c.currentTarget,n(!0);{let d=kt(c.currentTarget);s.addEventListener(d,"pointerup",i,!1),s.addEventListener(d,"pointermove",f=>{if(t.current){let m=mn(f);n(hn(m,t.current.getBoundingClientRect()))}},!1),s.addEventListener(d,"pointercancel",i,!1)}}});return{pressed:a,pressProps:e?{}:{onPointerDown:o,onPointerUp:i,onClick:i}}}function Ye(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}function Y(e,t,...a){if(e in t){let s=t[e];return typeof s=="function"?s(...a):s}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Y),n}var Ie=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(Ie||{}),gn=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(gn||{});function re(){let e=xn();return l.useCallback(t=>bn({mergeRefs:e,...t}),[e])}function bn({ourProps:e,theirProps:t,slot:a,defaultTag:n,features:s,visible:i=!0,name:o,mergeRefs:c}){c=c??vn;let d=Pt(t,e);if(i)return ge(d,a,n,o,c);let f=s??0;if(f&2){let{static:m=!1,...h}=d;if(m)return ge(h,a,n,o,c)}if(f&1){let{unmount:m=!0,...h}=d;return Y(m?0:1,{0(){return null},1(){return ge({...h,hidden:!0,style:{display:"none"}},a,n,o,c)}})}return ge(d,a,n,o,c)}function ge(e,t={},a,n,s){let{as:i=a,children:o,refName:c="ref",...d}=$e(e,["unmount","static"]),f=e.ref!==void 0?{[c]:e.ref}:{},m=typeof o=="function"?o(t):o;"className"in d&&d.className&&typeof d.className=="function"&&(d.className=d.className(t)),d["aria-labelledby"]&&d["aria-labelledby"]===d.id&&(d["aria-labelledby"]=void 0);let h={};if(t){let x=!1,p=[];for(let[v,y]of Object.entries(t))typeof y=="boolean"&&(x=!0),y===!0&&p.push(v.replace(/([A-Z])/g,g=>`-${g.toLowerCase()}`));if(x){h["data-headlessui-state"]=p.join(" ");for(let v of p)h[`data-${v}`]=""}}if(i===l.Fragment&&(Object.keys(Z(d)).length>0||Object.keys(Z(h)).length>0))if(!l.isValidElement(m)||Array.isArray(m)&&m.length>1){if(Object.keys(Z(d)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Z(d)).concat(Object.keys(Z(h))).map(x=>`  - ${x}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(x=>`  - ${x}`).join(`
`)].join(`
`))}else{let x=m.props,p=x?.className,v=typeof p=="function"?(...u)=>Ye(p(...u),d.className):Ye(p,d.className),y=v?{className:v}:{},g=Pt(m.props,Z($e(d,["ref"])));for(let u in h)u in g&&delete h[u];return l.cloneElement(m,Object.assign({},g,h,f,{ref:s(yn(m),f.ref)},y))}return l.createElement(i,Object.assign({},$e(d,["ref"]),i!==l.Fragment&&f,i!==l.Fragment&&h),m)}function xn(){let e=l.useRef([]),t=l.useCallback(a=>{for(let n of e.current)n!=null&&(typeof n=="function"?n(a):n.current=a)},[]);return(...a)=>{if(!a.every(n=>n==null))return e.current=a,t}}function vn(...e){return e.every(t=>t==null)?void 0:t=>{for(let a of e)a!=null&&(typeof a=="function"?a(t):a.current=t)}}function Pt(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},a={};for(let n of e)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(a[s]!=null||(a[s]=[]),a[s].push(n[s])):t[s]=n[s];if(t.disabled||t["aria-disabled"])for(let n in a)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(n)&&(a[n]=[s=>{var i;return(i=s?.preventDefault)==null?void 0:i.call(s)}]);for(let n in a)Object.assign(t,{[n](s,...i){let o=a[n];for(let c of o){if((s instanceof Event||s?.nativeEvent instanceof Event)&&s.defaultPrevented)return;c(s,...i)}}});return t}function Lt(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},a={};for(let n of e)for(let s in n)s.startsWith("on")&&typeof n[s]=="function"?(a[s]!=null||(a[s]=[]),a[s].push(n[s])):t[s]=n[s];for(let n in a)Object.assign(t,{[n](...s){let i=a[n];for(let o of i)o?.(...s)}});return t}function se(e){var t;return Object.assign(l.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function Z(e){let t=Object.assign({},e);for(let a in t)t[a]===void 0&&delete t[a];return t}function $e(e,t=[]){let a=Object.assign({},e);for(let n of t)n in a&&delete a[n];return a}function yn(e){return N.version.split(".")[0]>="19"?e.props.ref:e.ref}let wn="span";var Dt=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Dt||{});function jn(e,t){var a;let{features:n=1,...s}=e,i={ref:t,"aria-hidden":(n&2)===2?!0:(a=s["aria-hidden"])!=null?a:void 0,hidden:(n&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(n&4)===4&&(n&2)!==2&&{display:"none"}}};return re()({ourProps:i,theirProps:s,slot:{},defaultTag:wn,name:"Hidden"})}let It=se(jn),Nn=Symbol();function me(...e){let t=l.useRef(e);l.useEffect(()=>{t.current=e},[e]);let a=H(n=>{for(let s of t.current)s!=null&&(typeof s=="function"?s(n):s.current=n)});return e.every(n=>n==null||n?.[Nn])?void 0:a}var C=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(C||{});let En=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),$n=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var M=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(M||{}),ce=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(ce||{}),Sn=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Sn||{});function kn(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(En)).sort((t,a)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(a.tabIndex||Number.MAX_SAFE_INTEGER)))}function Fn(e=document.body){return e==null?[]:Array.from(e.querySelectorAll($n)).sort((t,a)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(a.tabIndex||Number.MAX_SAFE_INTEGER)))}var Tn=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Tn||{}),Pn=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Pn||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let Ln=["textarea","input"].join(",");function Dn(e){var t,a;return(a=(t=e?.matches)==null?void 0:t.call(e,Ln))!=null?a:!1}function ee(e,t=a=>a){return e.slice().sort((a,n)=>{let s=t(a),i=t(n);if(s===null||i===null)return 0;let o=s.compareDocumentPosition(i);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Q(e,t,{sorted:a=!0,relativeTo:n=null,skipElements:s=[]}={}){let i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,o=Array.isArray(e)?a?ee(e):e:t&64?Fn(e):kn(e);s.length>0&&o.length>1&&(o=o.filter(p=>!s.some(v=>v!=null&&"current"in v?v?.current===p:v===p))),n=n??i.activeElement;let c=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,o.indexOf(n))-1;if(t&4)return Math.max(0,o.indexOf(n))+1;if(t&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),f=t&32?{preventScroll:!0}:{},m=0,h=o.length,x;do{if(m>=h||m+h<=0)return 0;let p=d+m;if(t&16)p=(p+h)%h;else{if(p<0)return 3;if(p>=h)return 1}x=o[p],x?.focus(f),m+=c}while(x!==i.activeElement);return t&6&&Dn(x)&&x.select(),2}function In(e,t){return l.useMemo(()=>{var a;if(e.type)return e.type;let n=(a=e.as)!=null?a:"button";if(typeof n=="string"&&n.toLowerCase()==="button"||t?.tagName==="BUTTON"&&!t.hasAttribute("type"))return"button"},[e.type,e.as,t])}function An(){let e=l.useRef(!1);return ae(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function Cn({onFocus:e}){let[t,a]=l.useState(!0),n=An();return t?N.createElement(It,{as:"button",type:"button",features:Dt.Focusable,onFocus:s=>{s.preventDefault();let i,o=50;function c(){if(o--<=0){i&&cancelAnimationFrame(i);return}if(e()){if(cancelAnimationFrame(i),!n.current)return;a(!1);return}i=requestAnimationFrame(c)}i=requestAnimationFrame(c)}}):null}const At=l.createContext(null);function Mn(){return{groups:new Map,get(e,t){var a;let n=this.groups.get(e);n||(n=new Map,this.groups.set(e,n));let s=(a=n.get(t))!=null?a:0;n.set(t,s+1);let i=Array.from(n.keys()).indexOf(t);function o(){let c=n.get(t);c>1?n.set(t,c-1):n.delete(t)}return[i,o]}}}function _n({children:e}){let t=l.useRef(Mn());return l.createElement(At.Provider,{value:t},e)}function Ct(e){let t=l.useContext(At);if(!t)throw new Error("You must wrap your component in a <StableCollection>");let a=l.useId(),[n,s]=t.current.get(e,a);return l.useEffect(()=>s,[]),n}var Hn=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Hn||{}),Rn=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Rn||{}),On=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(On||{});let Wn={0(e,t){var a;let n=ee(e.tabs,m=>m.current),s=ee(e.panels,m=>m.current),i=n.filter(m=>{var h;return!((h=m.current)!=null&&h.hasAttribute("disabled"))}),o={...e,tabs:n,panels:s};if(t.index<0||t.index>n.length-1){let m=Y(Math.sign(t.index-e.selectedIndex),{[-1]:()=>1,0:()=>Y(Math.sign(t.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(i.length===0)return o;let h=Y(m,{0:()=>n.indexOf(i[0]),1:()=>n.indexOf(i[i.length-1])});return{...o,selectedIndex:h===-1?e.selectedIndex:h}}let c=n.slice(0,t.index),d=[...n.slice(t.index),...c].find(m=>i.includes(m));if(!d)return o;let f=(a=n.indexOf(d))!=null?a:e.selectedIndex;return f===-1&&(f=e.selectedIndex),{...o,selectedIndex:f}},1(e,t){if(e.tabs.includes(t.tab))return e;let a=e.tabs[e.selectedIndex],n=ee([...e.tabs,t.tab],i=>i.current),s=e.selectedIndex;return e.info.current.isControlled||(s=n.indexOf(a),s===-1&&(s=e.selectedIndex)),{...e,tabs:n,selectedIndex:s}},2(e,t){return{...e,tabs:e.tabs.filter(a=>a!==t.tab)}},3(e,t){return e.panels.includes(t.panel)?e:{...e,panels:ee([...e.panels,t.panel],a=>a.current)}},4(e,t){return{...e,panels:e.panels.filter(a=>a!==t.panel)}}},_e=l.createContext(null);_e.displayName="TabsDataContext";function ne(e){let t=l.useContext(_e);if(t===null){let a=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,ne),a}return t}let He=l.createContext(null);He.displayName="TabsActionsContext";function Re(e){let t=l.useContext(He);if(t===null){let a=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,Re),a}return t}function Bn(e,t){return Y(t.type,Wn,e,t)}let Un="div";function Vn(e,t){let{defaultIndex:a=0,vertical:n=!1,manual:s=!1,onChange:i,selectedIndex:o=null,...c}=e;const d=n?"vertical":"horizontal",f=s?"manual":"auto";let m=o!==null,h=le({isControlled:m}),x=me(t),[p,v]=l.useReducer(Bn,{info:h,selectedIndex:o??a,tabs:[],panels:[]}),y=l.useMemo(()=>({selectedIndex:p.selectedIndex}),[p.selectedIndex]),g=le(i||(()=>{})),u=le(p.tabs),b=l.useMemo(()=>({orientation:d,activation:f,...p}),[d,f,p]),j=H(E=>(v({type:1,tab:E}),()=>v({type:2,tab:E}))),$=H(E=>(v({type:3,panel:E}),()=>v({type:4,panel:E}))),S=H(E=>{F.current!==E&&g.current(E),m||v({type:0,index:E})}),F=le(m?e.selectedIndex:p.selectedIndex),L=l.useMemo(()=>({registerTab:j,registerPanel:$,change:S}),[]);ae(()=>{v({type:0,index:o??a})},[o]),ae(()=>{if(F.current===void 0||p.tabs.length<=0)return;let E=ee(p.tabs,I=>I.current);E.some((I,R)=>p.tabs[R]!==I)&&S(E.indexOf(p.tabs[F.current]))});let W={ref:x},P=re();return N.createElement(_n,null,N.createElement(He.Provider,{value:L},N.createElement(_e.Provider,{value:b},b.tabs.length<=0&&N.createElement(Cn,{onFocus:()=>{var E,I;for(let R of u.current)if(((E=R.current)==null?void 0:E.tabIndex)===0)return(I=R.current)==null||I.focus(),!0;return!1}}),P({ourProps:W,theirProps:c,slot:y,defaultTag:Un,name:"Tabs"}))))}let Kn="div";function Gn(e,t){let{orientation:a,selectedIndex:n}=ne("Tab.List"),s=me(t),i=l.useMemo(()=>({selectedIndex:n}),[n]),o=e,c={ref:s,role:"tablist","aria-orientation":a};return re()({ourProps:c,theirProps:o,slot:i,defaultTag:Kn,name:"Tabs.List"})}let zn="button";function qn(e,t){var a,n;let s=l.useId(),{id:i=`headlessui-tabs-tab-${s}`,disabled:o=!1,autoFocus:c=!1,...d}=e,{orientation:f,activation:m,selectedIndex:h,tabs:x,panels:p}=ne("Tab"),v=Re("Tab"),y=ne("Tab"),[g,u]=l.useState(null),b=l.useRef(null),j=me(b,t,u);ae(()=>v.registerTab(b),[v,b]);let $=Ct("tabs"),S=x.indexOf(b);S===-1&&(S=$);let F=S===h,L=H(k=>{var O;let pe=k();if(pe===ce.Success&&m==="auto"){let Ut=(O=kt(b))==null?void 0:O.activeElement,Be=y.tabs.findIndex(Vt=>Vt.current===Ut);Be!==-1&&v.change(Be)}return pe}),W=H(k=>{let O=x.map(pe=>pe.current).filter(Boolean);if(k.key===C.Space||k.key===C.Enter){k.preventDefault(),k.stopPropagation(),v.change(S);return}switch(k.key){case C.Home:case C.PageUp:return k.preventDefault(),k.stopPropagation(),L(()=>Q(O,M.First));case C.End:case C.PageDown:return k.preventDefault(),k.stopPropagation(),L(()=>Q(O,M.Last))}if(L(()=>Y(f,{vertical(){return k.key===C.ArrowUp?Q(O,M.Previous|M.WrapAround):k.key===C.ArrowDown?Q(O,M.Next|M.WrapAround):ce.Error},horizontal(){return k.key===C.ArrowLeft?Q(O,M.Previous|M.WrapAround):k.key===C.ArrowRight?Q(O,M.Next|M.WrapAround):ce.Error}}))===ce.Success)return k.preventDefault()}),P=l.useRef(!1),E=H(()=>{var k;P.current||(P.current=!0,(k=b.current)==null||k.focus({preventScroll:!0}),v.change(S),Ft(()=>{P.current=!1}))}),I=H(k=>{k.preventDefault()}),{isFocusVisible:R,focusProps:ie}=$t({autoFocus:c}),{isHovered:he,hoverProps:ye}=ln({isDisabled:o}),{pressed:B,pressProps:A}=pn({disabled:o}),J=l.useMemo(()=>({selected:F,hover:he,active:B,focus:R,autofocus:c,disabled:o}),[F,he,R,B,c,o]),U=Lt({ref:j,onKeyDown:W,onMouseDown:I,onClick:E,id:i,role:"tab",type:In(e,g),"aria-controls":(n=(a=p[S])==null?void 0:a.current)==null?void 0:n.id,"aria-selected":F,tabIndex:F?0:-1,disabled:o||void 0,autoFocus:c},ie,ye,A);return re()({ourProps:U,theirProps:d,slot:J,defaultTag:zn,name:"Tabs.Tab"})}let Yn="div";function Xn(e,t){let{selectedIndex:a}=ne("Tab.Panels"),n=me(t),s=l.useMemo(()=>({selectedIndex:a}),[a]),i=e,o={ref:n};return re()({ourProps:o,theirProps:i,slot:s,defaultTag:Yn,name:"Tabs.Panels"})}let Jn="div",Zn=Ie.RenderStrategy|Ie.Static;function Qn(e,t){var a,n,s,i;let o=l.useId(),{id:c=`headlessui-tabs-panel-${o}`,tabIndex:d=0,...f}=e,{selectedIndex:m,tabs:h,panels:x}=ne("Tab.Panel"),p=Re("Tab.Panel"),v=l.useRef(null),y=me(v,t);ae(()=>p.registerPanel(v),[p,v]);let g=Ct("panels"),u=x.indexOf(v);u===-1&&(u=g);let b=u===m,{isFocusVisible:j,focusProps:$}=$t(),S=l.useMemo(()=>({selected:b,focus:j}),[b,j]),F=Lt({ref:y,id:c,role:"tabpanel","aria-labelledby":(n=(a=h[u])==null?void 0:a.current)==null?void 0:n.id,tabIndex:b?d:-1},$),L=re();return!b&&((s=f.unmount)==null||s)&&!((i=f.static)!=null&&i)?N.createElement(It,{"aria-hidden":"true",...F}):L({ourProps:F,theirProps:f,slot:S,defaultTag:Jn,features:Zn,visible:b,name:"Tabs.Panel"})}let er=se(qn),tr=se(Vn),ar=se(Gn),nr=se(Xn),rr=se(Qn),oe=Object.assign(er,{Group:tr,List:ar,Panels:nr,Panel:rr});const sr=N.memo(function({tabs:t,defaultIndex:a=0,onTabChange:n,className:s,swipeEnabled:i=!0}){const[o,c]=l.useState(a),[d,f]=l.useState(null),m=K("spring"),h=K("fadeIn"),x=l.useRef(null),p=g=>{c(g),n?.(g),typeof window<"u"&&window.gtag&&window.gtag("event","tab_changed",{event_category:"Profile",event_label:"Tab Navigation",value:g,custom_parameters:{tab_name:t[g]?.label,total_tabs:t.length}})},v=(g,u)=>{if(!i)return;(Math.abs(u.offset.x)>50||Math.abs(u.velocity.x)>500)&&(u.offset.x>0&&o>0?p(o-1):u.offset.x<0&&o<t.length-1&&p(o+1)),f(null)},y=(g,u)=>{i&&(u.velocity.x>0?f("right"):u.velocity.x<0&&f("left"))};return t.length===0?null:r.jsxs("div",{className:w("flex h-full flex-col",s),children:[r.jsxs(oe.Group,{selectedIndex:o,onChange:p,children:[r.jsx("div",{className:"pt-safe-top flex-shrink-0",children:r.jsx(oe.List,{className:"m-4 flex justify-center rounded-xl bg-secondary/20 p-1",children:t.map((g,u)=>r.jsx(oe,{className:({selected:b})=>w("relative flex-1 rounded-lg px-6 py-3 text-sm font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2","min-h-[48pt]",b?"bg-primary text-white shadow-sm":"text-muted-foreground hover:bg-secondary/30 hover:text-foreground"),"aria-label":`Switch to ${g.label} view`,children:({selected:b})=>r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"relative z-10",children:g.label}),b&&r.jsx(T.div,{className:"absolute inset-0 rounded-lg bg-primary",layoutId:"activeTab",transition:m})]})},g.id))})}),r.jsx("div",{ref:x,className:"relative flex-1 overflow-hidden",children:r.jsx(oe.Panels,{className:"h-full",children:r.jsx(ve,{mode:"wait",initial:!1,children:t.map((g,u)=>r.jsx(oe.Panel,{className:w("h-full w-full focus:outline-none",u===o?"block":"hidden"),tabIndex:-1,children:r.jsx(T.div,{className:"h-full w-full",drag:i?"x":!1,dragConstraints:{left:0,right:0},dragElastic:.1,onDragStart:y,onDragEnd:v,initial:{opacity:0,x:u>o?20:u<o?-20:0},animate:{opacity:1,x:0,scale:d?.98:1},exit:{opacity:0,x:u>o?20:-20},transition:m,whileDrag:{scale:.98,rotateY:d==="left"?-2:d==="right"?2:0},children:g.content})},`${g.id}-${o}`))})})})]}),i&&d&&r.jsx(T.div,{className:"pointer-events-none absolute bottom-4 left-1/2 z-50 -translate-x-1/2 transform",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:h,children:r.jsxs("div",{className:"rounded-full bg-black/60 px-3 py-1 text-xs font-medium text-white backdrop-blur-sm",children:[d==="left"&&o<t.length-1&&"Swipe to next →",d==="right"&&o>0&&"← Swipe to previous"]})})]})}),ir=(e,t)=>[{id:"avatar",label:"Avatar",content:e},{id:"photo",label:"Photo",content:t}],Mt=qt,_t=Yt,Oe=l.forwardRef(({className:e,children:t,...a},n)=>r.jsxs(at,{ref:n,className:w("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[t,r.jsx(Xt,{asChild:!0,children:r.jsx(dt,{className:"h-4 w-4 opacity-50"})})]}));Oe.displayName=at.displayName;const Ht=l.forwardRef(({className:e,...t},a)=>r.jsx(st,{ref:a,className:w("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(ha,{className:"h-4 w-4"})}));Ht.displayName=st.displayName;const Rt=l.forwardRef(({className:e,...t},a)=>r.jsx(it,{ref:a,className:w("flex cursor-default items-center justify-center py-1",e),...t,children:r.jsx(dt,{className:"h-4 w-4"})}));Rt.displayName=it.displayName;const We=l.forwardRef(({className:e,children:t,position:a="popper",...n},s)=>r.jsx(Jt,{children:r.jsxs(nt,{ref:s,className:w("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...n,children:[r.jsx(Ht,{}),r.jsx(Zt,{className:w("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),r.jsx(Rt,{})]})}));We.displayName=nt.displayName;const or=l.forwardRef(({className:e,...t},a)=>r.jsx(ot,{ref:a,className:w("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));or.displayName=ot.displayName;const V=l.forwardRef(({className:e,children:t,...a},n)=>r.jsxs(rt,{ref:n,className:w("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(Qt,{children:r.jsx(ut,{className:"h-4 w-4"})})}),r.jsx(ea,{children:t})]}));V.displayName=rt.displayName;const lr=l.forwardRef(({className:e,...t},a)=>r.jsx(lt,{ref:a,className:w("-mx-1 my-1 h-px bg-muted",e),...t}));lr.displayName=lt.displayName;const cr={dexa:"DEXA Scan",scale:"Smart Scale",calipers:"Calipers",visual:"Visual Estimate",healthkit:"HealthKit"};function dr({open:e,onOpenChange:t,onSave:a,units:n}){const[s,i]=l.useState(""),[o,c]=l.useState([15]),[d,f]=l.useState("scale"),[m,h]=l.useState(!1),x=ct(),p=()=>{const g=parseFloat(s);isNaN(g)||g<=0||(a({weight:g,bodyFatPercentage:o[0],method:d,date:new Date}),i(""),c([15]),f("scale"),t(!1))},v=()=>{i(""),c([15]),f("scale"),t(!1)},y=async()=>{if(!(!be()||!x.isAvailable)){h(!0);try{if(!x.isAuthorized&&!await x.requestPermissions()){console.warn("HealthKit permissions not granted");return}const g=await x.getHealthData();if(g&&g.weight){let u=g.weight;n==="imperial"&&(u=Math.round(g.weight*2.20462*10)/10),a({weight:g.weight,bodyFatPercentage:o[0],method:"healthkit",date:new Date}),i(""),c([15]),f("scale"),t(!1),console.log("HealthKit data imported:",u,n==="imperial"?"lbs":"kg")}else console.warn("No weight data found in HealthKit")}catch(g){console.error("Error importing HealthKit data:",g)}finally{h(!1)}}};return r.jsx(ca,{open:e,onOpenChange:v,children:r.jsxs(da,{className:"max-w-md border-border bg-background text-foreground",children:[r.jsx(ua,{children:r.jsx(fa,{className:"text-xl font-semibold tracking-tight text-foreground",children:"Log New Measurement"})}),r.jsxs("div",{className:"space-y-6 py-4",children:[be()&&x.isAvailable&&r.jsxs("div",{className:"space-y-3",children:[r.jsx(z,{className:"text-sm font-medium uppercase tracking-wide text-muted-foreground",children:"Import from HealthKit"}),r.jsx(_,{type:"button",variant:"outline",onClick:y,disabled:m,className:"h-12 w-full border-border bg-secondary text-foreground hover:bg-muted",children:m?r.jsxs(r.Fragment,{children:[r.jsx(pa,{className:"mr-2 h-4 w-4 animate-spin"}),"Importing from HealthKit..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ga,{className:"mr-2 h-4 w-4"}),"Import from HealthKit"]})}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-0 flex items-center",children:r.jsx("span",{className:"w-full border-t border-border"})}),r.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:r.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or enter manually"})})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(z,{htmlFor:"weight",className:"text-sm font-medium uppercase tracking-wide text-muted-foreground",children:["Weight (",n==="metric"?"kg":"lbs",")"]}),r.jsx(ke,{id:"weight",type:"number",placeholder:"Enter weight",value:s,onChange:g=>i(g.target.value),className:"h-12 border-border bg-secondary text-base text-foreground placeholder:text-muted-foreground"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs(z,{className:"text-sm font-medium uppercase tracking-wide text-muted-foreground",children:["Body Fat: ",o[0].toFixed(1),"%"]}),r.jsx(Ae,{value:o,onValueChange:c,max:50,min:3,step:.1,className:"w-full"}),r.jsxs("div",{className:"flex justify-between text-xs font-medium text-muted-foreground",children:[r.jsx("span",{children:"3%"}),r.jsx("span",{children:"50%"})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(z,{className:"text-sm font-medium uppercase tracking-wide text-muted-foreground",children:"Method"}),r.jsxs(Mt,{value:d,onValueChange:g=>f(g),children:[r.jsx(Oe,{className:"h-12 border-border bg-secondary text-foreground",children:r.jsx(_t,{})}),r.jsx(We,{className:"border-border bg-background",children:Object.entries(cr).filter(([g])=>g!=="healthkit").map(([g,u])=>r.jsx(V,{value:g,className:"text-foreground hover:bg-muted",children:u},g))})]})]})]}),r.jsx("div",{className:"pt-4",children:r.jsx(_,{onClick:p,className:"h-12 w-full bg-primary text-base font-semibold text-primary-foreground hover:bg-primary/90",disabled:!s||parseFloat(s)<=0,children:"Save Measurement"})})]})})}const Ot=l.createContext(null);function ur({children:e,totalSteps:t,initialStep:a=0,onStepChange:n,onComplete:s}){const[i,o]=l.useState(a),[c,d]=l.useState(!1),f=aa.isNativePlatform(),m=i===0,h=i===t-1,x=(i+1)/t*100,p=l.useCallback(async()=>{if(c)if(f&&await we.impact({style:je.Light}),h)s?.();else{const u=i+1;o(u),d(!1),n?.(u)}},[i,h,c,s,n,f]),v=l.useCallback(async()=>{if(m)return;f&&await we.impact({style:je.Light});const u=i-1;o(u),d(!0),n?.(u)},[i,m,n,f]),y=l.useCallback(async u=>{u<0||u>=t||u===i||(f&&await we.impact({style:je.Light}),o(u),d(!0),n?.(u))},[i,t,n,f]),g={currentStep:i,totalSteps:t,isFirstStep:m,isLastStep:h,progress:x,goNext:p,goBack:v,goToStep:y,canGoNext:c,setCanGoNext:d};return r.jsx(Ot.Provider,{value:g,children:e})}function Ur(){const e=l.useContext(Ot);if(!e)throw new Error("useStepper must be used within a StepperProvider");return e}class fr{startTime=null;stepStartTimes={};backNavigationCount=0;usedHealthKit=!1;usedPresets=!1;startFlow(t){this.startTime=Date.now(),this.stepStartTimes={},this.backNavigationCount=0,this.usedHealthKit=!1,this.usedPresets=!1,this.track("log_weight_started",t)}completeStep(t){const a=this.stepStartTimes[t.step_number],n=a?(Date.now()-a)/1e3:0;this.track("step_completed",{...t,time_spent_seconds:Math.round(n*10)/10}),t.interaction_type==="preset"&&(this.usedPresets=!0),t.interaction_type==="healthkit"&&(this.usedHealthKit=!0)}startStep(t){this.stepStartTimes[t]=Date.now()}navigateBack(){this.backNavigationCount++}trackWeightInput(t){this.track("weight_input_method",t)}trackBodyFatInput(t){this.track("body_fat_input_method",t)}trackSave(t){const a=this.startTime?(Date.now()-this.startTime)/1e3:0;this.track("measurement_saved",{...t,total_flow_time_seconds:Math.round(a*10)/10,steps_back_navigated:this.backNavigationCount,used_healthkit:this.usedHealthKit,used_presets:this.usedPresets})}completeFlow(t){console.log("[Analytics] Flow completed:",t)}trackValidationError(t){this.track("validation_error",t)}trackAccessibility(t){this.track("accessibility_interaction",t)}track(t,a){console.log(`[Analytics] ${t}:`,a)}}const Xe=new fr,Vr={getInteractionType:e=>e.type==="keydown"||e.type==="keyup"?"keyboard":"tap",getPrecision:e=>{const t=e.toString(),a=t.indexOf(".");return a===-1?0:t.length-a-1},wasSnappedToIncrement:(e,t,a)=>{const n=Math.round(e/a)*a;return Math.abs(t-n)<.001}},mr=N.lazy(()=>ue(()=>import("./WeightStep-DKWJ3O9j.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(e=>({default:e.WeightStep}))),hr=N.lazy(()=>ue(()=>import("./BodyFatStep-V5sLE62T.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(e=>({default:e.BodyFatStep}))),pr=N.lazy(()=>ue(()=>import("./MethodStep-BfLiJLSE.js"),__vite__mapDeps([15,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(e=>({default:e.MethodStep}))),gr=N.lazy(()=>ue(()=>import("./ReviewStep-DZNmaqCI.js"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(e=>({default:e.ReviewStep})));function br({onComplete:e,onCancel:t,initialData:a}){const[n,s]=l.useState(0),[i,o]=l.useState(!1),[c,d]=l.useState(a?.weight||{value:0,unit:"lbs"}),[f,m]=l.useState(a?.bodyFat||{value:15}),[h,x]=l.useState(a?.method||{value:"scale",label:"Digital Scale"}),[p,v]=l.useState(),y=4,g=["Weight","Body Fat","Method","Review"],u=l.useCallback(()=>{n<y-1&&i?(s(P=>P+1),o(!1)):n===y-1&&$()},[n,i]),b=l.useCallback(()=>{n>0&&s(P=>P-1)},[n]),j=l.useCallback(P=>{P>=0&&P<y&&(s(P),o(!1))},[y]),$=async()=>{Xe.completeFlow({total_steps:y,completion_time_seconds:Date.now()-Xe.startTime,final_weight:`${c.value} ${c.unit}`,final_body_fat:`${f.value}%`,final_method:h.label,had_photo:!!p}),e({weight:c,bodyFat:f,method:h,photo:p})},S=P=>{j(P)},F=()=>{console.log("Photo capture not yet implemented")},L=(n+1)/y*100,W=()=>{switch(n){case 0:return r.jsx(mr,{value:c,onChange:d});case 1:return r.jsx(hr,{value:f,onChange:m});case 2:return r.jsx(pr,{value:h,onChange:x});case 3:return r.jsx(gr,{weight:c,bodyFat:f,method:h,onEditStep:S,onAddPhoto:F});default:return null}};return r.jsx(ur,{currentStep:n,totalSteps:y,canGoNext:i,setCanGoNext:o,goNext:u,goBack:b,goToStep:j,children:r.jsxs("div",{className:"flex h-full flex-col bg-background",children:[r.jsxs("div",{className:"pt-safe-top flex-shrink-0 px-6",children:[r.jsxs("div",{className:"flex h-14 items-center justify-between",children:[r.jsx("button",{onClick:n===0?t:b,className:"flex h-10 w-10 items-center justify-center rounded-full bg-secondary/20 transition-colors hover:bg-secondary/30","aria-label":n===0?"Cancel":"Go back",children:r.jsx(ba,{className:"h-5 w-5 text-foreground"})}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-sm font-medium text-muted-foreground",children:["Step ",n+1," of ",y]}),r.jsx("div",{className:"text-lg font-semibold text-foreground",children:g[n]})]}),r.jsx("div",{className:"flex h-10 w-10 items-center justify-center",children:r.jsxs("div",{className:"text-sm font-medium text-muted-foreground",children:[Math.round(L),"%"]})})]}),r.jsx("div",{className:"mb-6 mt-4",children:r.jsx("div",{className:"h-2 w-full overflow-hidden rounded-full bg-secondary/20",children:r.jsx(T.div,{className:"h-full rounded-full bg-primary",initial:{width:0},animate:{width:`${L}%`},transition:{duration:.3,ease:"easeOut"}})})})]}),r.jsx("div",{className:"flex-1 overflow-hidden",children:r.jsx("div",{className:"pb-safe-bottom h-full overflow-y-auto px-6",children:r.jsx(N.Suspense,{fallback:r.jsx("div",{className:"flex h-full items-center justify-center",children:r.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"})}),children:r.jsx(ve,{mode:"wait",children:r.jsx(T.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.25,type:"spring",damping:20},className:"h-full",children:W()},n)})})})}),r.jsx("div",{className:"flex-shrink-0 px-6 pb-6 pt-4",children:r.jsxs("div",{className:"flex gap-3",children:[n>0&&r.jsx(T.button,{onClick:b,className:"h-14 flex-1 rounded-2xl bg-secondary/20 font-semibold text-foreground transition-colors hover:bg-secondary/30",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:"Back"}),r.jsx(T.button,{onClick:u,disabled:!i,className:w("flex h-14 items-center justify-center gap-2 rounded-2xl font-semibold transition-all duration-200",n===0?"flex-1":"flex-[2]",i?"bg-primary text-primary-foreground hover:bg-primary/90":"cursor-not-allowed bg-secondary/20 text-muted-foreground"),whileTap:i?{scale:.98}:{},children:n===y-1?r.jsxs(r.Fragment,{children:[r.jsx(ut,{className:"h-5 w-5"}),"Save Entry"]}):r.jsxs(r.Fragment,{children:["Next",r.jsx(xa,{className:"h-5 w-5"})]})})]})})]})})}function xr({show:e,onClose:t,onSave:a,units:n,initialWeight:s,initialBodyFat:i}){const o=d=>{a({weight:d.weight.value,bodyFatPercentage:d.bodyFat.value,method:{value:d.method.value,label:d.method.label},date:new Date}),t()},c={weight:s?{value:s,unit:n==="imperial"?"lbs":"kg"}:void 0,bodyFat:i?{value:i}:void 0,method:void 0};return r.jsx(ve,{children:e&&r.jsx(T.div,{className:"fixed inset-0 z-50 bg-background",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:r.jsx(br,{onComplete:o,onCancel:t,initialData:c})})})}const vr=N.memo(function({onComplete:t,units:a,className:n}){const[s,i]=l.useState(""),[o,c]=l.useState(""),[d,f]=l.useState("scale"),[m,h]=l.useState(!1),[x,p]=l.useState({}),v=()=>{const b={},j=parseFloat(s),$=parseFloat(o);return!s||isNaN(j)||j<=0?b.weight="Please enter a valid weight":a==="imperial"&&(j<50||j>1e3)?b.weight="Weight must be between 50-1000 lbs":a==="metric"&&(j<20||j>500)&&(b.weight="Weight must be between 20-500 kg"),(!o||isNaN($)||$<1||$>60)&&(b.bodyFat="Body fat must be between 1-60%"),p(b),Object.keys(b).length===0},y=async b=>{if(b.preventDefault(),!!v()){h(!0);try{t({weight:parseFloat(s),bodyFatPercentage:parseFloat(o),method:d,date:new Date})}catch(j){console.error("Error saving initial weight:",j)}finally{h(!1)}}},g=a==="imperial"?"lbs":"kg",u=a==="imperial"?"e.g., 150":"e.g., 70";return r.jsx("div",{className:w("mx-auto w-full max-w-2xl",n),children:r.jsxs(na,{className:"border-border bg-background",children:[r.jsxs(ra,{className:"pb-6 text-center",children:[r.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-primary/10",children:r.jsx(Ue,{className:"h-8 w-8 text-primary"})}),r.jsx(sa,{className:"text-2xl font-bold text-foreground",children:"Let's get started!"}),r.jsx(ia,{className:"mx-auto max-w-md text-base text-muted-foreground",children:"To begin tracking your body composition journey, we need your current measurements"})]}),r.jsxs(oa,{children:[r.jsxs("form",{onSubmit:y,className:"space-y-6",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(z,{htmlFor:"weight",className:"flex items-center gap-2 text-base font-medium",children:[r.jsx(Ue,{className:"h-4 w-4 text-primary"}),"Current Weight (",g,")"]}),r.jsx(ke,{id:"weight",type:"number",value:s,onChange:b=>i(b.target.value),placeholder:u,className:w("h-12 text-lg",x.weight&&"border-destructive focus:border-destructive"),min:a==="imperial"?"50":"20",max:a==="imperial"?"1000":"500",step:"0.1",autoFocus:!0}),x.weight&&r.jsx("p",{className:"text-sm text-destructive",children:x.weight})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(z,{htmlFor:"bodyFat",className:"flex items-center gap-2 text-base font-medium",children:[r.jsx(va,{className:"h-4 w-4 text-primary"}),"Body Fat Percentage"]}),r.jsxs("div",{className:"relative",children:[r.jsx(ke,{id:"bodyFat",type:"number",value:o,onChange:b=>c(b.target.value),placeholder:"e.g., 15",className:w("h-12 pr-12 text-lg",x.bodyFat&&"border-destructive focus:border-destructive"),min:"1",max:"60",step:"0.1"}),r.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 transform text-muted-foreground",children:"%"})]}),x.bodyFat&&r.jsx("p",{className:"text-sm text-destructive",children:x.bodyFat}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Don't know your body fat? Start with an estimate - you can update it later"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(z,{htmlFor:"method",className:"flex items-center gap-2 text-base font-medium",children:[r.jsx(ya,{className:"h-4 w-4 text-primary"}),"Measurement Method"]}),r.jsxs(Mt,{value:d,onValueChange:f,children:[r.jsx(Oe,{className:"h-12 text-lg",children:r.jsx(_t,{})}),r.jsxs(We,{children:[r.jsx(V,{value:"scale",children:"Smart Scale"}),r.jsx(V,{value:"dexa",children:"DEXA Scan"}),r.jsx(V,{value:"bodpod",children:"Bod Pod"}),r.jsx(V,{value:"calipers",children:"Body Fat Calipers"}),r.jsx(V,{value:"visual",children:"Visual Estimate"}),r.jsx(V,{value:"other",children:"Other"})]})]})]}),r.jsx(_,{type:"submit",className:"h-12 w-full text-base font-semibold",disabled:m||!s||!o,children:m?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-r-transparent"}),"Setting up your profile..."]}):"Start Tracking"})]}),r.jsx("div",{className:"mt-6 rounded-lg bg-muted/30 p-4",children:r.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[r.jsx("strong",{children:"Tip:"})," Your measurements will be used to calculate FFMI and track progress over time. Don't worry about being precise - consistency is more important than accuracy."]})})]})]})})});function Je({children:e}){return r.jsx(r.Fragment,{children:e})}const yr=wa("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Wt=l.forwardRef(({className:e,variant:t,...a},n)=>r.jsx("div",{ref:n,role:"alert",className:w(yr({variant:t}),e),...a}));Wt.displayName="Alert";const wr=l.forwardRef(({className:e,...t},a)=>r.jsx("h5",{ref:a,className:w("mb-1 font-medium leading-none tracking-tight",e),...t}));wr.displayName="AlertTitle";const Bt=l.forwardRef(({className:e,...t},a)=>r.jsx("div",{ref:a,className:w("text-sm [&_p]:leading-relaxed",e),...t}));Bt.displayName="AlertDescription";function jr(){const[e,t]=l.useState(!1),[a,n]=l.useState(!1),{user:s}=la();l.useEffect(()=>{const c=localStorage.getItem("pending_email_confirmation"),d=localStorage.getItem("email_banner_dismissed");c&&!d&&s&&!a&&t(!0)},[s,a]);const i=()=>{t(!1),n(!0),localStorage.setItem("email_banner_dismissed","true")},o=async()=>{console.log("Resending confirmation email...")};return e?r.jsxs(Wt,{className:"mb-4 border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950",children:[r.jsx(ja,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),r.jsxs(Bt,{className:"flex w-full items-center justify-between",children:[r.jsx("div",{className:"flex-1",children:r.jsx("span",{className:"text-blue-800 dark:text-blue-200",children:"Please check your email and click the confirmation link to fully activate your account."})}),r.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[r.jsx(_,{variant:"outline",size:"sm",onClick:o,className:"h-8 border-blue-300 text-xs text-blue-700 hover:bg-blue-100 dark:border-blue-700 dark:text-blue-300 dark:hover:bg-blue-900",children:"Resend"}),r.jsx(_,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 text-blue-600 hover:bg-blue-100 dark:text-blue-400 dark:hover:bg-blue-900",children:r.jsx(Na,{className:"h-4 w-4"})})]})]})]}):null}const Nr={id:"1",name:"John Doe",email:"john@example.com",gender:"male",birthday:new Date("1990-01-15"),height:180},Er=[{id:"1",userId:"1",date:new Date("2024-01-01"),weight:80,bodyFatPercentage:15,method:"dexa"},{id:"2",userId:"1",date:new Date("2024-01-15"),weight:79.5,bodyFatPercentage:14.5,method:"scale"},{id:"3",userId:"1",date:new Date("2024-02-01"),weight:79,bodyFatPercentage:14,method:"calipers"},{id:"4",userId:"1",date:new Date("2024-02-15"),weight:78.5,bodyFatPercentage:13.5,method:"scale"}],$r={userId:"1",units:"imperial",healthKitSyncEnabled:!1,googleFitSyncEnabled:!1};function Sr(e){return e/2.20462}function Se(e){return e*2.20462}function Ze(e){const t=e/2.54,a=Math.floor(t/12),n=Math.round(t%12);return`${a}'${n}"`}function kr(e){return e/2.54}function Fr(e,t){return!e||e<=0||isNaN(e)?0:!t||t<0||t>100||isNaN(t)?e:e*(1-t/100)}function Tr(e,t){if(!e||e<=0||isNaN(e)||!t||t<=0||isNaN(t))return 0;const a=t/100,n=e/(a*a);return isNaN(n)||!isFinite(n)?0:n}function Pr(){const[e,t]=l.useState(Nr),[a,n]=l.useState(Er),[s,i]=l.useState(a.length-1),[o,c]=l.useState($r),d=l.useMemo(()=>[...a].sort((u,b)=>u.date.getTime()-b.date.getTime()),[a]),f=l.useMemo(()=>{const u=d[s];if(!u)return{bodyFatPercentage:0,weight:0,ffmi:0,leanBodyMass:0,date:new Date};const b=Fr(u.weight,u.bodyFatPercentage),j=Tr(b,e.height);return{bodyFatPercentage:u.bodyFatPercentage,weight:u.weight,ffmi:Math.round(j*10)/10,leanBodyMass:Math.round(b*10)/10,date:u.date}},[d,s,e.height]),m=l.useCallback(u=>{const b={...u,id:Date.now().toString(),userId:e.id};n(j=>[...j,b]),i(d.length)},[e.id,d.length]),h=l.useCallback(u=>{console.log("User updates:",u),t(b=>({...b,...u}))},[]),x=l.useCallback(u=>{c(b=>({...b,...u}))},[]),p=l.useCallback(u=>{if(!u||u<=0||isNaN(u))return o.units==="metric"?"0 kg":"0 lbs";if(o.units==="metric")return`${Math.round(u*10)/10} kg`;{const b=Se(u);return`${Math.round(b*10)/10} lbs`}},[o.units]),v=l.useCallback(u=>o.units==="metric"?`${u} cm`:Ze(u),[o.units]),y=l.useCallback(u=>{if(!u||u<=0||isNaN(u))return o.units==="metric"?"0 kg":"0 lbs";if(o.units==="metric")return`${Math.round(u*10)/10} kg`;{const b=Se(u);return`${Math.round(b*10)/10} lbs`}},[o.units]),g=l.useCallback(()=>{const u=new Date,b=new Date(e.birthday);let j=u.getFullYear()-b.getFullYear();const $=u.getMonth()-b.getMonth();return($<0||$===0&&u.getDate()<b.getDate())&&j--,j},[e.birthday]);return{user:e,metrics:d,currentMetrics:f,selectedDateIndex:s,setSelectedDateIndex:i,addMetric:m,updateUser:h,getUserAge:g,settings:o,updateSettings:x,getFormattedWeight:p,getFormattedHeight:v,getFormattedLeanBodyMass:y,utils:{lbsToKg:Sr,kgToLbs:Se,cmToFeet:Ze,cmToInches:kr}}}function Qe(e){if(!e)return 30;const t=new Date(e),a=new Date;let n=a.getFullYear()-t.getFullYear();const s=a.getMonth()-t.getMonth();return(s<0||s===0&&a.getDate()<t.getDate())&&n--,Math.max(18,Math.min(65,n))}N.lazy(()=>ue(()=>import("./AvatarSilhouette-BjiMYIz8.js"),__vite__mapDeps([17,1,2,3,4,5,6,7,9,10,11,12,13])).then(e=>({default:e.AvatarSilhouette})));const et=()=>r.jsx("div",{className:"flex h-full min-h-[400px] items-center justify-center bg-muted/30 md:min-h-0",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading 3D avatar..."})]})}),Lr=()=>{const e=ta(),t=ma();Pr();const a=ct(),{user:n,metrics:s,currentMetrics:i,selectedDateIndex:o,setSelectedDateIndex:c,addMetric:d,getUserAge:f,getFormattedWeight:m,getFormattedHeight:h,getFormattedLeanBodyMass:x,settings:p,utils:v}=t,y=t.loading,[g,u]=l.useState(0),[b,j]=l.useState(!1),[$,S]=l.useState(!1),[F,L]=l.useState(!1),[W,P]=l.useState(null),[E,I]=l.useState(!1),R=A=>{u(A)};Sa({onSwipeLeft:()=>e("/settings"),threshold:100}),N.useEffect(()=>{if(!E)if(be()&&a.isAvailable){(async()=>{try{if(a.isAuthorized||await a.requestPermissions(),a.isAuthorized){const U=await a.getHealthData();U&&U.weight&&(P(U),console.log("HealthKit weight data found:",U.weight))}}catch(U){console.warn("Error checking HealthKit data:",U)}finally{I(!0)}})();const J=setTimeout(()=>{E||(console.warn("HealthKit check timed out, proceeding without HealthKit data"),I(!0))},3e3);return()=>clearTimeout(J)}else I(!0)},[a.isAvailable,a.isAuthorized,E]);const ie=A=>{let J=A.weight;p.units==="imperial"&&(J=v.lbsToKg(A.weight)),d({...A,weight:J})},he=s.length>0&&s.some(A=>A.weight>0),ye=W&&W.weight>0,B=he||ye;return N.useEffect(()=>{!y&&n&&p&&E&&!B&&!F&&L(!0)},[y,n,p,E,B,F]),y||!n||!p?r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"}),r.jsx("p",{className:"text-muted-foreground",children:"Loading your data..."})]})}):F&&!B?r.jsx(Je,{children:r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background p-6",children:r.jsx(vr,{onComplete:A=>{ie(A),L(!1)},units:p.units})})}):r.jsx(Je,{children:r.jsxs("div",{className:"flex h-screen flex-col overflow-hidden bg-background text-foreground md:min-h-screen md:overflow-auto",children:[r.jsx("div",{className:"px-4 pt-4 md:px-6",children:r.jsx(jr,{})}),r.jsxs("div",{className:"hidden items-center justify-between border-b border-border px-6 py-4 md:flex",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"LogYourBody"}),r.jsx($a,{})]}),r.jsxs("div",{className:"flex gap-3",children:[be()&&r.jsx(_,{size:"icon",variant:"outline",onClick:()=>e("/healthkit-test"),className:"border-border bg-secondary text-foreground hover:bg-muted",title:"HealthKit Testing (Development)",children:r.jsx(Ea,{className:"h-4 w-4"})}),r.jsx(_,{size:"icon",variant:"outline",onClick:()=>{B?S(!0):L(!0)},className:"h-10 w-10 border-border bg-secondary text-foreground hover:bg-muted",children:r.jsx(Ve,{className:"h-4 w-4"})}),r.jsx(_,{size:"icon",variant:"outline",onClick:()=>e("/settings"),className:"h-10 w-10 border-border bg-secondary text-foreground hover:bg-muted",children:r.jsx(Ke,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"flex min-h-0 flex-1 flex-col md:flex-row",children:[r.jsxs("div",{className:"relative min-h-0 flex-1 md:w-2/3",children:[r.jsx(sr,{tabs:ir(r.jsx(l.Suspense,{fallback:r.jsx(et,{}),children:r.jsx(ze,{gender:n.gender,bodyFatPercentage:i.bodyFatPercentage,showPhoto:!1,className:"h-full w-full",weight:i.weight,height:n.height,age:Qe(n.birthday)})}),r.jsx(l.Suspense,{fallback:r.jsx(et,{}),children:r.jsx(ze,{gender:n.gender,bodyFatPercentage:i.bodyFatPercentage,showPhoto:!0,profileImage:n.profileImage,className:"h-full w-full",weight:i.weight,height:n.height,age:Qe(n.birthday)})})),defaultIndex:g,onTabChange:R,swipeEnabled:!0,className:"h-full w-full"}),r.jsxs("div",{className:"top-safe-top absolute right-4 z-20 flex gap-3 md:hidden",children:[r.jsx(_,{size:"icon",variant:"outline",onClick:()=>{B?S(!0):L(!0)},className:"h-10 w-10 border-border bg-background/80 text-foreground shadow-lg backdrop-blur-sm hover:bg-muted",children:r.jsx(Ve,{className:"h-4 w-4"})}),r.jsx(_,{size:"icon",variant:"outline",onClick:()=>e("/settings"),className:"h-10 w-10 border-border bg-background/80 text-foreground shadow-lg backdrop-blur-sm hover:bg-muted",children:r.jsx(Ke,{className:"h-4 w-4"})})]})]}),r.jsx("div",{className:"min-h-0 flex-1 border-border md:w-1/3 md:flex-none md:border-l",children:r.jsx(Ia,{metrics:i,user:n,userAge:f(),formattedWeight:m(i.weight),formattedHeight:h(n.height),formattedLeanBodyMass:x(i.leanBodyMass)})})]}),r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Aa,{metrics:s,selectedIndex:o,onIndexChange:c})}),r.jsx(dr,{open:b,onOpenChange:j,onSave:ie,units:p.units}),r.jsx(xr,{show:$,onSave:ie,onClose:()=>S(!1),units:p.units,initialWeight:i.weight>0?p.units==="imperial"?v.kgToLbs(i.weight):i.weight:void 0,initialBodyFat:i.bodyFatPercentage})]})})},Kr=Object.freeze(Object.defineProperty({__proto__:null,default:Lr},Symbol.toStringTag,{value:"Module"}));export{Kr as D,Ge as L,Vr as a,Ur as u,Xe as w};
