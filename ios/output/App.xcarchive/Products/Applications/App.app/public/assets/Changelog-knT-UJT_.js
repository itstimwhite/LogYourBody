import{j as e}from"./ui-vendor-B29bBmtv.js";import{R as P,a as i,u as W}from"./react-vendor-CGPzL8fz.js";import{c as z,B as v,a as Y,s as O}from"./index-CterjluU.js";import{I as R}from"./input-BGHS8jIm.js";import{V as $}from"./VersionDisplay-xo0BDl1-.js";import{p as F,aa as L,n as G,O as U,b as T,ab as M,a0 as q}from"./utils-vendor-eZsCaz-O.js";import"./data-vendor-CtvEhjhB.js";import"./analytics-vendor-CXgENQ1a.js";const J=P.memo(function({items:o,itemHeight:c,containerHeight:b,renderItem:k,className:j,overscan:y=5}){const[d,g]=i.useState(0),p=i.useRef(null),u=i.useMemo(()=>{const s=Math.max(0,Math.floor(d/c)-y),a=Math.min(o.length-1,Math.ceil((d+b)/c)+y);return{startIndex:s,endIndex:a}},[d,c,b,o.length,y]),w=i.useMemo(()=>{const s=[];for(let a=u.startIndex;a<=u.endIndex;a++)s.push({index:a,item:o[a]});return s},[o,u]),x=o.length*c,N=u.startIndex*c,h=s=>{g(s.currentTarget.scrollTop)};return i.useEffect(()=>{const s=p.current;if(!s)return;const a=()=>{g(s.scrollTop)};return s.addEventListener("scroll",a,{passive:!0}),()=>s.removeEventListener("scroll",a)},[]),e.jsx("div",{ref:p,className:z("overflow-auto",j),style:{height:b},onScroll:h,children:e.jsx("div",{style:{height:x,position:"relative"},children:e.jsx("div",{style:{transform:`translateY(${N}px)`,position:"absolute",top:0,left:0,right:0},children:w.map(({item:s,index:a})=>e.jsx("div",{style:{height:c},children:k(s,a)},a))})})})}),se=()=>{const I=W(),[o,c]=i.useState([]),[b,k]=i.useState(!0),[j,y]=i.useState(null),[d,g]=i.useState(""),[p,u]=i.useState(!1),[w,x]=i.useState("idle"),[N,h]=i.useState("");i.useEffect(()=>{s()},[]);const s=async()=>{try{const t=await fetch("https://api.github.com/repos/itstimwhite/LogYourBody/commits?per_page=50");if(t.ok){const m=(await t.json()).map(n=>({sha:n.sha,message:n.commit.message,author:n.commit.author,committer:n.commit.committer,url:n.html_url,html_url:n.html_url}));c(m)}else c(a())}catch(t){console.error("Failed to fetch commits:",t),c(a())}finally{k(!1)}},a=()=>[{sha:"3a20798",message:`Fix Settings page mobile blank screen issue

- Add proper null checks for user and settings data
- Add useEffect to update form states when user data loads
- Add fallback values for all user properties to prevent crashes
- Fix potential race conditions with data loading
- Ensure Settings page renders properly on mobile devices`,author:{name:"Claude",email:"noreply@anthropic.com",date:new Date().toISOString()},committer:{name:"Claude",email:"noreply@anthropic.com",date:new Date().toISOString()},url:"https://github.com/itstimwhite/LogYourBody/commit/3a20798",html_url:"https://github.com/itstimwhite/LogYourBody/commit/3a20798"},{sha:"8a343e5",message:`Implement comprehensive PWA version management and cache handling

- Add PWAUpdatePrompt component with user-friendly update notifications
- Create VersionDisplay component showing app version and build info
- Implement usePWAUpdate hook for proper SW update lifecycle management
- Add version information to PWA manifest and build process
- Ensure proper cache clearing when updates are available
- Display version info in Dashboard header and Settings page
- Configure PWA for prompt-based updates instead of auto-updates`,author:{name:"Claude",email:"noreply@anthropic.com",date:new Date(Date.now()-24*60*60*1e3).toISOString()},committer:{name:"Claude",email:"noreply@anthropic.com",date:new Date(Date.now()-24*60*60*1e3).toISOString()},url:"https://github.com/itstimwhite/LogYourBody/commit/8a343e5",html_url:"https://github.com/itstimwhite/LogYourBody/commit/8a343e5"},{sha:"800a15d",message:`Fix biometric authentication implementation

- Fix critical counter initialization bug in WebAuthn hook
- Improve credential verification during authentication
- Remove biometric login from login page (should be for existing users only)
- Add proper error handling for WebAuthn operations
- Enhance biometric setup component integration`,author:{name:"Claude",email:"noreply@anthropic.com",date:new Date(Date.now()-2*24*60*60*1e3).toISOString()},committer:{name:"Claude",email:"noreply@anthropic.com",date:new Date(Date.now()-2*24*60*60*1e3).toISOString()},url:"https://github.com/itstimwhite/LogYourBody/commit/800a15d",html_url:"https://github.com/itstimwhite/LogYourBody/commit/800a15d"}],D=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),E=t=>new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),_=t=>{const r=t.split(`
`)[0].toLowerCase();return r.includes("fix")||r.includes("bug")?{type:"fix",color:""}:r.includes("feat")||r.includes("add")||r.includes("implement")?{type:"feature",color:""}:r.includes("update")||r.includes("improve")||r.includes("enhance")?{type:"improvement",color:""}:r.includes("refactor")||r.includes("clean")?{type:"refactor",color:""}:{type:"change",color:""}},A=t=>{const r=t.split(`
`),m=r[0],n=r.slice(2).join(`
`).trim();return{title:m,body:n}},B=t=>{if(!t)return"";const r=t.replace(/\n+/g," ").trim();return r.length>120?`${r.slice(0,117)}...`:r},S=t=>t.substring(0,7),V=async t=>{if(t.preventDefault(),!d||!d.includes("@")){x("error"),h("Please enter a valid email address");return}u(!0),x("idle");try{const{error:r}=await O.from("email_subscriptions").insert({email:d.toLowerCase(),subscription_type:"changelog",metadata:{source:"changelog_page",subscribed_via:"web_form"}});if(r)if(r.code==="23505")x("success"),h("You are already subscribed to changelog updates!");else throw r;else x("success"),h("Successfully subscribed to changelog updates!"),g("")}catch(r){console.error("Subscription error:",r),x("error"),h("Failed to subscribe. Please try again later.")}finally{u(!1),setTimeout(()=>{x("idle"),h("")},5e3)}};return b?e.jsx("div",{className:"flex min-h-svh items-center justify-center bg-linear-bg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-2 border-linear-purple border-t-transparent"}),e.jsx("p",{className:"text-linear-text-secondary",children:"Loading changelog..."})]})}):e.jsxs("div",{className:"min-h-svh bg-linear-bg text-linear-text font-inter",children:[e.jsx("div",{className:"sticky top-0 z-40 border-b border-linear-border bg-linear-bg/95 backdrop-blur supports-[backdrop-filter]:bg-linear-bg/60",children:e.jsx("div",{className:"container mx-auto max-w-6xl px-4 py-4 sm:px-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(v,{size:"icon",variant:"ghost",onClick:()=>I(-1),"aria-label":"Go back",className:"h-10 w-10 text-linear-text-secondary hover:text-linear-text hover:bg-linear-border/50 transition-colors",children:e.jsx(F,{className:"h-4 w-4","aria-hidden":"true"})}),e.jsx($,{})]})})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-linear-purple/5 via-linear-bg to-linear-bg"}),e.jsx("div",{className:"container relative mx-auto max-w-6xl px-4 py-12 sm:px-6 sm:py-16",children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:gap-3",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-linear-purple/10",children:e.jsx(L,{className:"h-6 w-6 text-linear-purple","aria-hidden":"true"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-linear-text sm:text-4xl",children:"Changelog"}),e.jsx("p",{className:"mt-2 text-lg text-linear-text-secondary sm:text-xl",children:"Stay up to date with the latest features, improvements, and fixes"})]})]}),e.jsxs("div",{className:"mt-8 rounded-lg border border-linear-border bg-linear-card p-4",children:[e.jsxs("form",{onSubmit:V,className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[e.jsx(R,{type:"email","aria-label":"Email address",placeholder:"Your email",value:d,onChange:t=>g(t.target.value),disabled:p,className:"flex-1 h-10 text-sm"}),e.jsx(v,{type:"submit",disabled:p||!d,className:"h-10 px-4 flex-shrink-0 bg-linear-text text-linear-bg hover:bg-linear-text/90",children:p?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-r-transparent"}):"Sign up"})]}),N&&e.jsxs("p",{className:`mt-2 flex items-center gap-2 text-sm ${w==="success"?"text-green-500":"text-red-500"}`,"aria-live":"polite",children:[w==="success"?e.jsx(G,{className:"h-4 w-4","aria-hidden":"true"}):e.jsx(U,{className:"h-4 w-4","aria-hidden":"true"}),N]})]})]})})]}),e.jsxs("div",{className:"container mx-auto max-w-4xl px-4 py-8 sm:px-6",children:[j&&e.jsx("div",{className:"mb-6 rounded-lg border border-red-500/20 bg-red-500/10 p-4",children:e.jsx("p",{className:"text-sm text-red-500",children:j})}),e.jsx("div",{className:"block sm:hidden",children:o.map((t,r)=>{const{title:m,body:n}=A(t.message),f=B(n),l=_(m),C=r===o.length-1;return e.jsxs("div",{className:"relative mb-6",children:[!C&&e.jsx("div",{className:"absolute bottom-0 left-5 top-12 w-px bg-linear-border"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full border-2 border-linear-border bg-linear-bg",children:e.jsx(L,{className:"h-4 w-4 text-linear-text-tertiary","aria-hidden":"true"})})}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsxs("div",{className:"rounded-lg border border-linear-border bg-linear-card p-3 transition-shadow hover:shadow-md",children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center gap-2",children:[e.jsx(Y,{variant:"outline",className:`border text-xs ${l.type==="fix"?"border-red-500/30 bg-red-500/10 text-red-500":l.type==="feature"?"border-green-500/30 bg-green-500/10 text-green-500":l.type==="improvement"?"border-blue-500/30 bg-blue-500/10 text-blue-500":l.type==="refactor"?"border-purple-500/30 bg-purple-500/10 text-purple-500":"border-linear-border bg-linear-card text-linear-text-tertiary"}`,children:l.type}),e.jsx("code",{className:"rounded bg-linear-border px-2 py-1 font-mono text-xs text-linear-text-tertiary",children:S(t.sha)})]}),e.jsx("h3",{className:"mb-2 break-words text-base font-semibold text-linear-text",children:m})]}),f&&e.jsx("p",{className:"mb-3 text-sm text-linear-text-secondary",children:f}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-linear-text-tertiary",children:[e.jsx(T,{className:"h-3 w-3","aria-hidden":"true"}),e.jsxs("span",{children:[D(t.author.date)," at"," ",E(t.author.date)]})]}),e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>window.open(t.html_url,"_blank"),"aria-label":`View commit ${S(t.sha)}`,className:"h-8 text-xs text-linear-text-secondary hover:text-linear-text hover:bg-linear-border/50",children:[e.jsx(M,{className:"mr-1 h-3 w-3","aria-hidden":"true"}),"View"]})]})]})})]})]},t.sha)})}),e.jsx("div",{className:"hidden sm:block",children:e.jsx(J,{items:o,itemHeight:220,containerHeight:800,className:"space-y-6",renderItem:(t,r)=>{const{title:m,body:n}=A(t.message),f=B(n),l=_(m),C=r===o.length-1;return e.jsxs("div",{className:"relative mb-6",children:[!C&&e.jsx("div",{className:"absolute bottom-0 left-5 top-12 w-px bg-linear-border"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full border-2 border-linear-border bg-linear-bg",children:e.jsx(L,{className:"h-4 w-4 text-linear-text-tertiary","aria-hidden":"true"})})}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsxs("div",{className:"rounded-lg border border-linear-border bg-linear-card p-6 transition-all hover:border-linear-text-tertiary",children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx(Y,{variant:"outline",className:`border text-xs ${l.type==="fix"?"border-red-500/30 bg-red-500/10 text-red-500":l.type==="feature"?"border-green-500/30 bg-green-500/10 text-green-500":l.type==="improvement"?"border-blue-500/30 bg-blue-500/10 text-blue-500":l.type==="refactor"?"border-purple-500/30 bg-purple-500/10 text-purple-500":"border-linear-border bg-linear-card text-linear-text-tertiary"}`,children:l.type}),e.jsx("code",{className:"rounded bg-linear-border px-2 py-1 font-mono text-xs text-linear-text-tertiary",children:S(t.sha)})]}),e.jsx("h3",{className:"mb-2 break-words text-lg font-semibold text-linear-text",children:m})]}),e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>window.open(t.html_url,"_blank"),"aria-label":`View commit ${S(t.sha)}`,className:"flex-shrink-0 text-linear-text-secondary hover:text-linear-text hover:bg-linear-border/50",children:[e.jsx(M,{className:"mr-1 h-3 w-3","aria-hidden":"true"}),"View"]})]}),f&&e.jsx("p",{className:"mb-4 text-sm text-linear-text-secondary",children:f}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-linear-text-tertiary",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-3 w-3","aria-hidden":"true"}),e.jsxs("span",{children:[D(t.author.date)," at"," ",E(t.author.date)]})]})})]})})]})]})}})}),e.jsx("div",{className:"mt-12 border-t border-linear-border pt-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center text-sm text-linear-text-tertiary sm:flex-row sm:justify-center sm:gap-4",children:[e.jsx(q,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:"View full commit history on"}),e.jsx(v,{variant:"link",size:"sm",onClick:()=>window.open("https://github.com/itstimwhite/LogYourBody/commits/main","_blank"),className:"h-auto p-0 text-linear-purple hover:text-linear-purple/80",children:"GitHub"})]})})]})]})};export{se as default};
