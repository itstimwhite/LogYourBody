import{j as e}from"./ui-vendor-QE-oobKj.js";import{R as B,a as n,u as M}from"./react-vendor-ClhmtWht.js";import{g as Y,B as y,a as T,s as P}from"./index-D69SCsvj.js";import{I as W}from"./input-8QVqFKxr.js";import{V as O}from"./VersionDisplay-BxpSyFxf.js";import{n as R,N as k,s as V,m as z,B as F,O as G,b as U,Q as $}from"./utils-vendor-BycXaddh.js";import"./data-vendor-DLfSSb0Z.js";import"./analytics-vendor-CXgENQ1a.js";const Q=B.memo(function({items:c,itemHeight:o,containerHeight:x,renderItem:w,className:b,overscan:f=5}){const[l,g]=n.useState(0),h=n.useRef(null),m=n.useMemo(()=>{const r=Math.max(0,Math.floor(l/o)-f),a=Math.min(c.length-1,Math.ceil((l+x)/o)+f);return{startIndex:r,endIndex:a}},[l,o,x,c.length,f]),v=n.useMemo(()=>{const r=[];for(let a=m.startIndex;a<=m.endIndex;a++)r.push({index:a,item:c[a]});return r},[c,m]),d=c.length*o,j=m.startIndex*o,u=r=>{g(r.currentTarget.scrollTop)};return n.useEffect(()=>{const r=h.current;if(!r)return;const a=()=>{g(r.scrollTop)};return r.addEventListener("scroll",a,{passive:!0}),()=>r.removeEventListener("scroll",a)},[]),e.jsx("div",{ref:h,className:Y("overflow-auto",b),style:{height:x},onScroll:u,children:e.jsx("div",{style:{height:d,position:"relative"},children:e.jsx("div",{style:{transform:`translateY(${j}px)`,position:"absolute",top:0,left:0,right:0},children:v.map(({item:r,index:a})=>e.jsx("div",{style:{height:o},children:w(r,a)},a))})})})}),se=()=>{const N=M(),[c,o]=n.useState([]),[x,w]=n.useState(!0),[b,f]=n.useState(null),[l,g]=n.useState(""),[h,m]=n.useState(!1),[v,d]=n.useState("idle"),[j,u]=n.useState("");n.useEffect(()=>{r()},[]);const r=async()=>{try{const t=await fetch("https://api.github.com/repos/itstimwhite/LogYourBody/commits?per_page=50");if(t.ok){const p=(await t.json()).map(i=>({sha:i.sha,message:i.commit.message,author:i.commit.author,committer:i.commit.committer,url:i.html_url,html_url:i.html_url}));o(p)}else o(a())}catch(t){console.error("Failed to fetch commits:",t),o(a())}finally{w(!1)}},a=()=>[{sha:"3a20798",message:`Fix Settings page mobile blank screen issue

- Add proper null checks for user and settings data
- Add useEffect to update form states when user data loads
- Add fallback values for all user properties to prevent crashes
- Fix potential race conditions with data loading
- Ensure Settings page renders properly on mobile devices`,author:{name:"Claude",email:"noreply@anthropic.com",date:new Date().toISOString()},committer:{name:"Claude",email:"noreply@anthropic.com",date:new Date().toISOString()},url:"https://github.com/itstimwhite/LogYourBody/commit/3a20798",html_url:"https://github.com/itstimwhite/LogYourBody/commit/3a20798"},{sha:"8a343e5",message:`Implement comprehensive PWA version management and cache handling

- Add PWAUpdatePrompt component with user-friendly update notifications
- Create VersionDisplay component showing app version and build info
- Implement usePWAUpdate hook for proper SW update lifecycle management
- Add version information to PWA manifest and build process
- Ensure proper cache clearing when updates are available
- Display version info in Dashboard header and Settings page
- Configure PWA for prompt-based updates instead of auto-updates`,author:{name:"Claude",email:"noreply@anthropic.com",date:new Date(Date.now()-24*60*60*1e3).toISOString()},committer:{name:"Claude",email:"noreply@anthropic.com",date:new Date(Date.now()-24*60*60*1e3).toISOString()},url:"https://github.com/itstimwhite/LogYourBody/commit/8a343e5",html_url:"https://github.com/itstimwhite/LogYourBody/commit/8a343e5"},{sha:"800a15d",message:`Fix biometric authentication implementation

- Fix critical counter initialization bug in WebAuthn hook
- Improve credential verification during authentication
- Remove biometric login from login page (should be for existing users only)
- Add proper error handling for WebAuthn operations
- Enhance biometric setup component integration`,author:{name:"Claude",email:"noreply@anthropic.com",date:new Date(Date.now()-2*24*60*60*1e3).toISOString()},committer:{name:"Claude",email:"noreply@anthropic.com",date:new Date(Date.now()-2*24*60*60*1e3).toISOString()},url:"https://github.com/itstimwhite/LogYourBody/commit/800a15d",html_url:"https://github.com/itstimwhite/LogYourBody/commit/800a15d"}],C=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),L=t=>new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),I=t=>{const s=t.split(`
`)[0].toLowerCase();return s.includes("fix")||s.includes("bug")?{type:"fix",color:"bg-red-100 text-red-800 border-red-200"}:s.includes("feat")||s.includes("add")||s.includes("implement")?{type:"feature",color:"bg-green-100 text-green-800 border-green-200"}:s.includes("update")||s.includes("improve")||s.includes("enhance")?{type:"improvement",color:"bg-blue-100 text-blue-800 border-blue-200"}:s.includes("refactor")||s.includes("clean")?{type:"refactor",color:"bg-purple-100 text-purple-800 border-purple-200"}:{type:"change",color:"bg-gray-100 text-gray-800 border-gray-200"}},D=t=>{const s=t.split(`
`),p=s[0],i=s.slice(2).join(`
`).trim();return{title:p,body:i}},E=t=>t.substring(0,7),A=async t=>{if(t.preventDefault(),!l||!l.includes("@")){d("error"),u("Please enter a valid email address");return}m(!0),d("idle");try{const{error:s}=await P.from("email_subscriptions").insert({email:l.toLowerCase(),subscription_type:"changelog",metadata:{source:"changelog_page",subscribed_via:"web_form"}});if(s)if(s.code==="23505")d("success"),u("You are already subscribed to changelog updates!");else throw s;else d("success"),u("Successfully subscribed to changelog updates!"),g("")}catch(s){console.error("Subscription error:",s),d("error"),u("Failed to subscribe. Please try again later.")}finally{m(!1),setTimeout(()=>{d("idle"),u("")},5e3)}};return x?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading changelog..."})]})}):e.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[e.jsx("div",{className:"sticky top-0 z-40 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"container mx-auto max-w-6xl px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(y,{size:"icon",variant:"outline",onClick:()=>N(-1),className:"h-10 w-10 border-border bg-secondary text-foreground hover:bg-muted",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsx(O,{})]})})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-background to-background"}),e.jsx("div",{className:"container relative mx-auto max-w-6xl px-6 py-16",children:e.jsxs("div",{className:"max-w-3xl",children:[e.jsxs("div",{className:"mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(k,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight",children:"Changelog"}),e.jsx("p",{className:"mt-2 text-xl text-muted-foreground",children:"Stay up to date with the latest features, improvements, and fixes"})]})]}),e.jsx("div",{className:"mt-8 rounded-lg border border-border bg-card p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(V,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Subscribe to updates"}),e.jsx("p",{className:"mb-4 text-muted-foreground",children:"Get notified when we ship new features and improvements"}),e.jsxs("form",{onSubmit:A,className:"flex gap-2",children:[e.jsx(W,{type:"email",placeholder:"Enter your email",value:l,onChange:t=>g(t.target.value),disabled:h,className:"flex-1"}),e.jsx(y,{type:"submit",disabled:h||!l,className:"flex-shrink-0",children:h?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-r-transparent"}):"Subscribe"})]}),j&&e.jsxs("div",{className:`mt-3 flex items-center gap-2 text-sm ${v==="success"?"text-green-600":"text-destructive"}`,children:[v==="success"?e.jsx(z,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"}),j]})]})]})})]})})]}),e.jsxs("div",{className:"container mx-auto max-w-4xl px-6 py-8",children:[b&&e.jsx("div",{className:"mb-6 rounded-lg border border-destructive/20 bg-destructive/10 p-4",children:e.jsx("p",{className:"text-sm text-destructive",children:b})}),e.jsx(Q,{items:c,itemHeight:280,containerHeight:800,className:"space-y-8",renderItem:(t,s)=>{const{title:p,body:i}=D(t.message),S=I(p),_=s===c.length-1;return e.jsxs("div",{className:"relative mb-8",children:[!_&&e.jsx("div",{className:"absolute bottom-0 left-5 top-12 w-px bg-border"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full border-2 border-border bg-background",children:e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})})}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsxs("div",{className:"rounded-lg border border-border bg-card p-6 transition-shadow hover:shadow-md",children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx(T,{variant:"outline",className:`border text-xs ${S.color}`,children:S.type}),e.jsx("code",{className:"rounded bg-muted px-2 py-1 font-mono text-xs",children:E(t.sha)})]}),e.jsx("h3",{className:"mb-2 break-words text-lg font-semibold text-foreground",children:p})]}),e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>window.open(t.html_url,"_blank"),className:"flex-shrink-0",children:[e.jsx(G,{className:"mr-1 h-3 w-3"}),"View"]})]}),i&&e.jsx("div",{className:"mb-4 whitespace-pre-line border-l-2 border-border pl-4 text-sm text-muted-foreground",children:i}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"h-3 w-3"}),e.jsxs("span",{children:[C(t.author.date)," at"," ",L(t.author.date)]})]})})]})})]})]})}}),e.jsx("div",{className:"mt-12 border-t border-border pt-8",children:e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm text-muted-foreground",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:"View full commit history on"}),e.jsx(y,{variant:"link",size:"sm",onClick:()=>window.open("https://github.com/itstimwhite/LogYourBody/commits/main","_blank"),className:"h-auto p-0 text-primary hover:text-primary/80",children:"GitHub"})]})})]})]})};export{se as default};
